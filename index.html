<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>單字測驗網頁版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #374151;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #6b7280;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #4b5563;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 50;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.75);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #1f2937;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            width: 90%;
            max-width: 500px;
        }
        .modal-content-lg {
            max-width: 700px;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
        }
        .pronounce-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.25rem;
            color: #38bdf8;
            vertical-align: middle;
        }
        .pronounce-btn:hover {
            color: #7dd3fc;
        }
        .ui-message {
            text-align: center;
            margin-top: 0.5rem;
            padding: 0.5rem;
            border-radius: 0.375rem;
        }
        .ui-message-success {
            background-color: #10b981;
            color: white;
        }
        .ui-message-error {
            background-color: #ef4444;
            color: white;
        }
        .ui-message-info {
            background-color: #3b82f6;
            color: white;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 to-slate-800 text-white min-h-screen flex flex-col items-center justify-center p-4">

    <div id="app-container" class="bg-slate-800 p-6 sm:p-8 rounded-xl shadow-2xl w-full max-w-2xl">
        <h1 class="text-3xl sm:text-4xl font-bold mb-6 sm:mb-8 text-center text-sky-400">1200單字檢測練習</h1>

        <!-- Initial Screen: Mode Selection -->
        <div id="initial-screen" class="space-y-4">
            <h2 class="text-xl font-semibold text-center text-sky-300 mb-4">請選擇操作模式：</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="md:col-span-1 space-y-3 p-4 bg-slate-700/50 rounded-lg shadow-md">
                     <h3 class="text-lg font-medium text-center text-sky-400 mb-3">等級測驗模式</h3>
                     <div id="level-selection-buttons" class="grid grid-cols-2 gap-3">
                         {/* Level buttons generated by JS */}
                     </div>
                 </div>

                <div class="md:col-span-1 space-y-3 p-4 bg-slate-700/50 rounded-lg shadow-md">
                    <h3 class="text-lg font-medium text-center text-purple-400 mb-3">單字複習</h3>
                    <button id="start-review-mode-btn" class="w-full font-semibold py-3 px-4 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105 bg-purple-500 hover:bg-purple-600 text-white">
                        進入列表複習
                    </button>
                    <button id="start-review-quiz-mode-btn" class="w-full mt-2 font-semibold py-3 px-4 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105 bg-indigo-500 hover:bg-indigo-600 text-white">
                        進入範圍測驗
                    </button>
                </div>

                <div class="md:col-span-1 space-y-3 p-4 bg-slate-700/50 rounded-lg shadow-md">
                    <h3 class="text-lg font-medium text-center text-amber-400 mb-2">錯誤複習與管理</h3>
                    <button id="start-error-review-quiz-btn" class="w-full font-semibold py-3 px-4 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105 bg-amber-500 hover:bg-amber-600 text-white">
                        錯誤複習測驗 (<span id="error-review-count">0</span>題)
                    </button>
                    <button id="show-error-list-btn" class="w-full font-semibold py-3 px-4 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105 bg-teal-500 hover:bg-teal-600 text-white">
                        查看錯誤單字列表
                    </button>
                    <button id="clear-errors-initial-btn" class="w-full bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out">
                        清除所有累積錯誤
                    </button>
                </div>
            </div>
            <div id="initial-feedback" class="text-center mt-2"></div>
        </div>


        <!-- Quiz Screen -->
        <div id="quiz-screen" class="space-y-6" style="display: none;">
            <div class="text-center">
                <p id="quiz-progress-text" class="text-slate-400 text-sm mb-1"></p>
                <p id="question-chinese-text" class="text-2xl sm:text-3xl font-semibold text-amber-400 my-3 p-3 bg-slate-700 rounded-lg leading-relaxed"></p>
                <p class="text-slate-300">請輸入英文單字：</p>
            </div>
            <input type="text" id="user-input" class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none" placeholder="輸入英文單字...">
            <button id="submit-answer-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105">
                提交答案
            </button>
            <div id="quiz-feedback" class="mt-4 text-center font-medium"></div>
            <button id="back-from-quiz-btn" class="w-full mt-4 bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md">
                返回選擇
            </button>
        </div>

        <!-- Finished Screen -->
        <div id="finished-screen" class="text-center space-y-6" style="display: none;">
            <h2 id="finished-title" class="text-3xl font-bold text-sky-400">測驗結束！</h2>
            <p id="final-score-text" class="text-2xl text-amber-400"></p>
            
            <div id="error-summary-container" class="mt-6 text-left" style="display: none;">
                <h3 class="text-xl font-semibold mb-3 text-red-400">本次測驗後，累積錯誤單字：</h3>
                <ul id="error-summary-list" class="space-y-2 max-h-60 overflow-y-auto bg-slate-700 p-4 rounded-lg custom-scrollbar">
                    </ul>
            </div>
            <p id="no-cumulative-errors-msg" class="text-green-400 text-lg font-semibold" style="display: none;">太棒了！目前沒有累積的錯誤單字！🎉</p>
            <div id="finished-feedback" class="text-center mt-2"></div>

            <div class="space-y-4 mt-6">
                <button id="reset-to-initial-btn" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105">
                    返回主選單
                </button>
                <button id="clear-errors-finished-btn" class="w-full bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out">
                    清除所有累積錯誤
                </button>
            </div>
        </div>

        <!-- Review Mode Screen (List Review) -->
        <div id="review-mode-screen" style="display: none;" class="space-y-6">
            <h2 class="text-2xl sm:text-3xl font-bold mb-6 text-center text-purple-400">單字列表複習</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                <div class="space-y-4">
                    <label for="review-level-select" class="block text-lg font-medium text-sky-300">1. 選擇複習等級：</label>
                    <select id="review-level-select" class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-purple-500 outline-none">
                        {/* Level options generated by JS */}
                    </select>
                </div>

                <div id="review-range-selection" class="space-y-4" style="display:none;">
                    <p class="text-lg font-medium text-sky-300">2. 選擇題庫區間 (等級 <span id="selected-review-level-text" class="font-bold text-purple-300"></span>)：</p>
                    <div id="review-range-buttons" class="grid grid-cols-2 gap-3">
                        {/* Range buttons generated by JS */}
                    </div>
                </div>
            </div>


            <div id="review-vocab-list-container" class="mt-6" style="display:none;">
                <h3 class="text-xl font-semibold mb-3 text-purple-300">單字列表 (等級 <span id="review-list-level-text" class="font-bold"></span> - 區間: <span id="selected-review-range-text" class="font-bold"></span>)：</h3>
                <div id="review-vocab-list" class="space-y-3 max-h-[50vh] overflow-y-auto bg-slate-700/70 p-4 rounded-lg custom-scrollbar shadow-inner">
                    {/* Vocab list generated by JS */}
                </div>
            </div>
             <div id="review-mode-feedback" class="text-center mt-2"></div>

            <button id="back-to-initial-from-review-btn" class="w-full mt-6 bg-sky-500 hover:bg-sky-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md">
                返回主選單
            </button>
        </div>

        <!-- Review Quiz Selection Screen -->
        <div id="review-quiz-selection-screen" style="display: none;" class="space-y-6">
            <h2 class="text-2xl sm:text-3xl font-bold mb-6 text-center text-indigo-400">範圍測驗模式</h2>
            
            <div class="space-y-4">
                <label for="review-quiz-level-select" class="block text-lg font-medium text-sky-300">1. 選擇測驗等級：</label>
                <select id="review-quiz-level-select" class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none">
                    {/* 等級選項會由 JS 生成 */}
                </select>
            </div>

            <div id="review-quiz-range-selection" class="space-y-4" style="display:none;">
                <p class="text-lg font-medium text-sky-300">2. 選擇測驗範圍 (等級 <span id="selected-review-quiz-level-text" class="font-bold text-indigo-300"></span>，每20題一組)：</p>
                <div id="review-quiz-range-buttons" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3">
                    {/* 測驗範圍按鈕會由 JS 生成 */}
                </div>
            </div>
            <div id="review-quiz-mode-feedback" class="text-center mt-2"></div>

            <button id="back-to-initial-from-review-quiz-btn" class="w-full mt-6 bg-sky-500 hover:bg-sky-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md">
                返回主選單
            </button>
        </div>


        <!-- Footer -->
        <div class="mt-8 text-center text-xs text-slate-500">
            <p id="total-vocab-count-text">總詞彙數 (已載入): 0</p>
            <p class="mt-1">錯誤記錄儲存在您的瀏覽器中。</p>
            <p class="mt-4 text-slate-600">版權說明：</p>
            <p class="text-slate-600">1. 題庫來源：三光國中英文單字檢測題庫</p>
            <p class="text-slate-600">2. 程式設計：Samuel Wu</p>
        </div>
    </div>

    <!-- Modals -->
    <div id="clear-confirm-modal" class="modal">
        <div class="modal-content text-center">
            <h3 class="text-xl font-semibold mb-4 text-sky-400">確認清除</h3>
            <p class="text-slate-300 mb-6">您確定要清除所有累積的錯誤記錄嗎？此操作無法復原。</p>
            <div class="flex justify-center space-x-4">
                <button id="confirm-clear-btn" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-150">
                    確認清除
                </button>
                <button id="cancel-clear-btn" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-150">
                    取消
                </button>
            </div>
        </div>
    </div>

    <div id="error-list-modal" class="modal">
        <div class="modal-content modal-content-lg"> 
            <h3 class="text-2xl font-semibold mb-4 text-sky-400 text-center">錯誤單字列表</h3>
            <div id="error-list-modal-content" class="space-y-3 overflow-y-auto flex-grow pr-2 custom-scrollbar">
                </div>
            <button id="close-error-list-btn" class="mt-6 bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-150 self-center">
                關閉
            </button>
        </div>
    </div>

    <script>
        // --- 詞彙資料 ---
        // ######################################################################

        const rawLevel1Vocab = `

1. a(an) [ə] ([ən]) 一個(張、隻...等)

2. am [æm] (我)是

3. are [ar] (複數)是

4. arm [arm] 手臂

5. at [ǝt / 'æt] 在...(小地方)

6. baby [ bebi] 嬰兒/年幼的

7. bad [bæd] 壞的/差的

8. ball [bol] 球

9. bed [bed] 床鋪

10. big [big] 大的

11. bird [b3-d] 鳥類

12. boy [boi] 男孩

13. bus [bs] 公車/巴士

14. car [kar] 汽車

15. card [kard] 卡片

16. cat [kæt] 貓咪

17. come [km] 過來

18. cup [kʌp] 杯子 

19. desk [desk] 書桌

20. do [du] 做(助動詞)

21. dog [dog] 狗

22. door [dor] 門

23. ear [ir] 耳朵

24. egg [eg] 蛋

25. eight [et] 八

26. eye [ai] 眼睛

27. fat [fæt] 胖的

28. fine [fain] 好的

29. five [faiv] 五

30. food [fud] 食物

31. four [for] 四

32. girl [gɜrl] 女孩

33. go [go] 去

34. good [gʊd] 好的

35. great [gret] 好棒的

36. he [hi] 他(主格)

37. here [hir] (在)這裡

38. home [hom] 家

39. hot [hɑt] 熱的

40. how [haʊ] 如何;怎(麼)樣

41. I [aı] 我(主格)

42. in [ın] 在...裡面

43. is [ız] 第三人稱[是]

44. it [ıt] 它/牠(主格)

45. job [dʒɑb] 工作

46. jog [dʒɑg] 慢跑

47. kid [kıd] 小孩/開玩笑

48. king [kıŋ] 國王

49. leg [leg] 腿

50. lion [\`laıən] 獅子

51. love [lʌv] 愛

52. lunch [lʌntʃ] 午餐

53. man [mæn] 男人(單數)

54. milk [mılk] 牛奶

55. Miss [mıs] 小姐(未婚)

56. moon [mun] 月亮

57. Mr. [\`mıstər] 先生

58. Mrs. [\`mısız] 太太(已婚)

59. Ms. [mız] 女士(不知是否已婚)

60. name [nem] 名字

61. neck [nɛk] 脖子

62. new [nju] 新的

63. nice [naıs] 好的

64. nine [naın] 九

65. no [no] 不

66. nose [noz] 鼻子

67. not [nɑt] 不是

68. now [naʊ] 現在

69. ok [\`o\`ke] 可以的

70. one [wʌn] 一

71. or [ɔr] 或者/否則

72. pen [pɛn] 筆

73. pet [pɛt] 寵物

74. picture [\`pıktʃər] 相片/圖畫

75. pie [paı] 吃的派

76. pig [pig] 豬

77. red [rɛd] 紅色(的)

78. room [rum] 房間

79. run [rʌn] 跑步

80. sad [sæd] 悲傷的

81. say [se] 說話

82. seven [\`sɛvən] 七

83. she [ʃi] 她(主格)

84. sit [sıt] 坐

85. six [sıks] 六

86. sky [skaı] 天空

87. sun [sʌn] 太陽

88. tall [tɔl] 高的

89. tea [ti] 茶水

90. ten [tɛn] 十

91. that [ðæt] 那個

92. they [ðe] 他們(主格)

93. three [θri] 三

94. today [tə\`de] 今天

95. too [tu] 也是/太

96. toy [tɔı] 玩具

97. tree [tri] 樹木

98. two [tu] 兩

99. walk [wɔk] 走路

100. water [\`wɔtər] 水/用水澆

101. we [wi] 我們(主格)

102. what [wʌt] 什麼

103. who [hu] 誰

104. yes [jɛs] 是的

105. yeah [jɛə] 是的

106. you [ju] 你/你們(主格)

`;

        const rawLevel2Vocab = `

1. air [er] 空氣

2. and [ænd] 和/並且

3. ant [ænt] 螞蟻

4. apple [\`æpəl] 蘋果

5. bee [bi] 蜜蜂

6. birthday [\`bɜrθde] 生日

7. black [blæk] 黑色(的)

8. box [bɑks] 箱子;盒子

9. brother [\`brʌðər] 兄或弟

10. brown [braʊn] 棕色;咖啡色

11. busy [\`bızi] 忙碌

12. but [bʌt] 但是;不過

13. cake [kek] 蛋糕

14. candy [\`kændi] 糖果

15. cap [kæp] 鴨舌帽

16. chair [tʃer] 椅子

17. classmate [\`klæsmet] 同學

18. classroom [\`klæsrum] 教室

19. clock [klɑk] 時鐘

20. close [kloz] 關上/接近的

21. coffee [\`kɔfi] 咖啡

22. cola [\`kolə] 可樂

23. coke [kok] 可樂

24. color [\`kʌlər] 顏色

25. cow [kaʊ] 乳牛;母牛

26. cute [kjut] 可愛的

27. day [de] 日;天/白天

28. dear [dır] 親愛的

29. dirty [\`dɜrti] 骯髒的

30. doll [dɑl] 洋娃娃

31. draw [drɔ] 畫畫/素描

32. eat [it] 吃

33. English [\`ıŋglıʃ] 英語/英文

34. father [\`fɑðər] 爸爸

35. flower [\`flaʊər] 花

36. fox [fɑks] 狐狸

37. friendly [\`frɛndli] 友善的

38. frog [frɑg] 青蛙

39. fruit [frut] 水果

40. give [gıv] 給予

41. glue [glu] 膠水

42. gray [gre] 灰色(的)

43. green [grin] 綠色(的)

44. ham [hæm] 火腿

45. hello [hə\`lo] 哈囉/你好/喂

46. hen [hɛn] 母雞

47. hey [he] 嘿

48. hi [haı] 嗨/你好

49. hippo [\`hıpo] 河馬

50. its [ıts] 它的/牠的

51. old [old] 老的/舊的

52. on [ɑn] 在~上面(有接觸到)

53. pencil [\`pɛnsəl] 鉛筆

54. picnic [\`pıknık] 野餐

55. pink [pıŋk] 粉紅色(的)

56. please [pliz] 請;拜託

57. read [rid] 讀;閱讀

58. real [riəl] 真正的

59. rice [raıs] 米;飯

60. ROC 中華民國

61. ruler [\`rulər] 尺

62. sandwich [\`sændwıtʃ] 三明治

63. school [skul] 學校

64. sea [si] 海

65. see [si] 看見

66. sheep [ʃip] 綿羊

67. ship [ʃıp] 船;大船

68. shirt [ʃɜrt] 襯衫

69. short [ʃɔrt] 短/矮的

70. shy [ʃaı] 害羞的

71. sing [sıŋ] 唱歌

72. singer [\`sıŋər] 歌手;歌星

73. sister [\`sıstər] 姊或妹/修女

74. slow [slo] 慢的

75. small [smɔl] 小的

76. sofa [\`sofə] 沙發

77. son [sʌn] 兒子

78. song [sɔŋ] 歌曲

79. soup [sup] 湯

80. stand [stænd] 站立/忍受/攤位

81. store [stɔr] 商店/儲存

82. student [\`studnt] 學生

83. study [\`stʌdi] 研讀/書房

84. table [\`tebəl] 桌子;茶几

85. talk [tɔk] 談話

86. teacher [\`titʃər] 老師

87. thank [θæŋk] 感謝;謝謝

88. these [ðiz] 這些

89. those [ðoz] 那些

90. toe [to] 腳趾

91. under [\`ʌndər] 在...之下

92. USA 美國

93. very [\`vɛri] 非常;很

94. want [wɑnt] 想要

95. wash [wɑʃ] 洗

96. week [wik] 星期;週

97. white [hwaıt] 白色(的)

98. woman [\`wʊmən] 女人(單)

99. year [jır] 年

100. yellow [\`jɛlo] 黃色(的)

101. zoo [zu] 動物園

`;

        const rawLevel3Vocab = `

1. a.m. 上午 ante[\`ænti] 之前(拉丁文) meridiem [mə\`rıdiəm] 正午

2. about [ə\`baʊt] 關於;大約

3. after [\`æftər] 在...之後

4. afternoon [æftər\`nun] 下午

5. ago [ə\`go] 在...時間以前

6. America [ə\`mɛrıkə] 美國

7. animal [\`ænəməl] 動物

8. any [\`ɛni] 任何

9. ask [æsk] 要求/問

10. autumn [\`ɔtəm] 秋天

11. bag [bæg] 袋子

12. banana [bə\`nænə] 香蕉

13. beef [bif] 牛肉

14. bicycle [\`baısıkəl] 腳踏車

15. bike [baık] 腳踏車

16. body [\`bɑdi] 身體

17. breakfast [\`brɛkfəst] 早餐

18. chalk [tʃɔk] 粉筆

19. child [tʃaıld] 小孩(單數)

20. coat [kot] 大衣

21. computer [kəm\`pjutər] 電腦

22. cookie [\`kʊki] 餅乾 = cooky

23. cooky [\`kʊki] 餅乾 = cookie

24. cry [kraı] 哭泣

25. dad [dæd] 爸爸

26. daddy [\`dædi] 爸爸

27. dance [dæns] 跳舞

28. die [daı] 死亡

29. dining room[\`daınıŋ rum] 飯廳

30. dinner [\`dınər] 晚餐

31. dollar [\`dɑlər] 元

32. down [daʊn] 向下

33. dress [drɛs] 洋裝/給...穿衣服

34. drink [drıŋk] 喝/飲料

35. drive [draıv] 駕駛(車)

36. dry [draı] 乾的/把...弄乾

37. duck [dʌk] 鴨子

38. elephant [\`ɛləfənt] 大象

39. eleven [ı\`lɛvən] 十一

40. eraser [ı\`resər] 橡皮擦

41. evening [\`ivnıŋ] 傍晚

42. every [\`ɛvri] 每一個

43. family [\`fæməli] 家人/家庭

44. feel [fil] 感覺;覺得

45. fly [flaı] 飛翔

46. friend [frɛnd] 朋友

47. good-bye [gʊd\`baı] 再見

48. hair [her] 毛髮

49. hand [hænd] 手/交給

50. hat [hæt] 寬沿帽

51. head [hɛd] 頭

52. help [hɛlp] 幫忙

53. horse [hɔrs] 馬

54. hot dog [\`hɑt dɔg] 熱狗

55. hour [aʊr] 小時

56. house [haʊs] 房子

57. hungry [\`hʌŋgri] 飢餓的

58. ice [aıs] 冰塊

59. ice cream [\`aıs krim] 冰淇淋

60. into [\`ıntu] 進入/對...很著迷

61. invite [ın\`vaıt] 邀請

62. join [dʒɔın] 參加/加入

63. juice [dʒus] 果汁

64. kick [kık] 用腳踢

65. kiss [kıs] 親吻

66. kitchen [\`kıtʃən] 廚房

67. kite [kaıt] 風箏

68. learn [lɜrn] 學習

69. money [\`mʌni] 金錢

70. morning [\`mɔrnıŋ] 早上

71. need [nid] 需要

72. o'clock [ə\`klɑk] 時間整點

73. p.m. 下午 post [post] 過去的/之後 meridiem [mə\`rıdiəm] 正午的

74. really [\`riəli] 實在是

75. salt [sɔlt] 鹽巴

76. sleep [slip] 睡覺

77. spell [spɛl] 拼(字)

78. star [stɑr] 明星/星星

79. start [stɑrt] 開始

80. telephone [\`tɛlə,fon] 電話

81. there [ðer] 那裡

82. together [tə\`gɛðər] 一起

83. train [tren] 火車

84. trip [trıp] 旅行

85. truck [trʌk] 卡車

86. try [traı] 嘗試

87. up [ʌp] 往上

88. wait [wet] 等待

89. wear [wer] 穿戴

90. weather [\`wɛðər] 天氣

91. when [wɛn] 何時

92. where [wer] 哪裡

93. why [waı] 為何

94. with [wıð] 和...一起

95. word [wɜrd] 字/話語

96. work [wɜrk] 工作/作品

97. worker [\`wɜrkər] 工人

98. write [raıt] 寫字/寫作

99. yesterday [\`jɛstərde] 昨天

100. zero [\`zıro] 零

101. true [tru] 真的

`;

        const rawLevel4Vocab = `

1. be [bi] 是(原形動詞)

2. bookstore [\`bʊk,stɔr] 書局

3. bread [brɛd] 麵包

4. buy [baı] 購買

5. cellphone [\`sɛlfon] 手機

6. city [\`sɪti] 城市

7. date [det] 日期/約會

8. dig [dıg] 挖掘

9. dish [dıʃ] 碗盤

10. does [dʌz] 做(助動詞)

11. eighteen [\`e\`tin] 十八

12. eighty [\`eti] 八十

13. even [\`ivən] 甚至

14. fall [fɔl] 秋天/掉落

15. feed [fid] 餵食

16. fifteen [fɪf\`tin] 十五

17. fifty [\`fɪfti] 五十

18. forty [\`fɔrti] 四十

19. fourteen [fɔr\`tin] 十四

20. from [frʌm] 從...

21. grandpa [\`grændpɑ] 祖父 grandfather [\`grændfɑðər]

22. grandma [\`grændmɑ] 祖母 grandmother [\`grændmʌðər]

23. homework [\`homwɜrk] 作業

24. long [lɔŋ] 長的/久的

25. movie [\`muvi] 電影

26. never [\`nɛvər] 從不/絕不

27. news [njuz] 新聞/消息

28. newspaper [\`njuzpepər] 報紙

29. nineteen [\`naın\`tin] 十九

30. ninety [\`naɪnti] 九十

31. of [ʌv] 屬於...的

32. office [\`ɔfɪs] 辦公室

33. out [aʊt] 從...出來;在外面

34. page [pedʒ] 頁面

35. paper [\`pepər] 紙張/文件/論文

36. part [pɑrt] 一部份

37. pay [pe] 付錢

38. pork [pɔrk] 豬肉

39. restaurant [\`rɛstərənt] 餐廳

40. road [rod] 道路

41. salad [\`sæləd] 沙拉

42. same [sem] 相同的

43. season [\`sizən] 季節

44. send [sɛnd] 寄送

45. seventeen [sɛvən\`tin] 十七

46. seventy [\`sɛvənti] 七十

47. sir [sɜr] 先生/長官

48. sixteen [sıks\`tin] 十六

49. sixty [\`sıksti] 六十

50. size [saız] 尺寸

51. skirt [skɜrt] 裙子

52. smart [smɑrt] 聰明的

53. smell [smɛl] 聞到/氣味

54. snack [snæk] 點心

55. snake [snek] 蛇

56. snow [sno] 雪/下雪

57. so [so] 這麼/如此...

58. soccer [\`sɑkər] 足球

59. socks [sɑks] 襪子(複數)

60. some [sʌm] 某些/一些

61. soon [sun] 不久/馬上

62. sound [saʊnd] 聲音/聽起來像

63. speak [spik] 說話/演說

64. sport [spɔrt] 運動

65. spring [sprıŋ] 春天/泉水

66. station [\`steʃən] 車站/...處所

67. stay [ste] 短暫停留/待在...

68. steak [stek] 牛排

69. still [stıl] 仍然

70. stop [stɑp] 停止;停車站

71. street [strit] 街道

72. strong [strɔŋ] 強壯的;濃烈的

73. sugar [\`ʃʊgər] 糖

74. summer [\`sʌmər] 夏天

75. sunny [\`sʌni] 晴朗的

76. supermarket [\`supər\`mɑrkɪt] 超市

77. sure [ʃʊr] 當然

78. swim [swım] 游泳

79. tape [tep] 錄影/錄音帶

80. television [\`tɛləvɪʒən] 電視

81. thirsty [\`θɜrsti] 口渴的

82. thirteen [θɜr\`tin] 十三

83. thirty [\`θɜrti] 三十

84. this [ðɪs] 這個

85. tomorrow [tə\`mɔro] 明天

86. twelve [twɛlv] 十二

87. twenty [\`twɛnti] 二十

88. use [juz] 使用

89. vacation [ve\`keʃən] 假期

90. vegetable [\`vɛdʒtəbəl] 蔬菜

91. visit [\`vɪzɪt] 拜訪參觀

92. wall [wɔl] 牆壁

93. warm [wɔrm] 溫暖的

94. weekend [\`wik\`ɛnd] 週末

95. wet [wɛt] 潮濕的

96. which [wɪtʃ] 哪一個

97. wind [wɪnd] 風

98. window [\`wɪndo] 窗戶

99. winter [\`wɪntər] 冬天

100. wonderful [\`wʌndərfəl] 美好的

101. worry [\`wɜri] 擔心憂慮

102. writer [\`raɪtər] 作家/作者

103. wrong [rɔŋ] 錯誤的

104. young [jʌŋ] 年輕的

`;

        const rawLevel5Vocab = `

1. a few [fju] 一些

2. a little [\`lɪtəl] 一些;一點

3. a lot [lɑt] 許多;很多

4. afraid [ə\`fred] 害怕的

5. again [ə\`gɛn] 又;再次

6. all [ɔl] 全部;(三者以上)都

7. always [\`ɔlwez] 總是

8. answer [\`ænsər] 回答/答案

9. anyone [\`ɛniwʌn] 任何人 anybody [\`ɛnibɑdi]

10. anything [\`ɛniθıŋ] 任何事物

11. become [bı\`kʌm] 變成;成為

12. before [bı\`fɔr] 在...之前

13. begin [bı\`gın] 開始

14. blue [blu] 藍色(的)/憂鬱(的)

15. both [boθ] (兩者)都

16. butter [\`bʌtər] 奶油

17. careful [\`kerfəl] 小心(的);仔細(的)

18. catch [kætʃ] 抓;接/趕上

19. chicken [\`tʃıkən] 雞/雞肉

20. class [klæs] 班(級)/課

21. cloudy [\`klaʊdi] 多雲的

22. cook [kʊk] 煮飯;烹煮/廚師

23. cut [kʌt] 切/割

24. daughter [\`dɔtər] 女兒

25. delicious [dı\`lıʃəs] 美味的;可口的;好吃的

26. each [itʃ] 每(在)一(個)

27. early [\`ɜrli] 早(的;地)

28. easy [\`izi] 簡單的;容易的

29. enjoy [ın\`dʒɔı] 享受/喜愛

30. enough [ı\`nʌf] 足夠的

31. everybody [\`ɛvri\`bɑdi] 每個人

32. everyone [\`ɛvriwʌn] 每個人

33. everything [\`ɛvriθıŋ] 每件事物

34. face [fes] 臉/面對

35. farm [fɑrm] 農場;農田

36. fast [fæst] 快的/快地

37. fire [faıər] 火

38. first [fɜrst] 第一(的)

39. fish [fıʃ] 魚/魚肉/釣魚

40. forget [fər\`gɛt] 忘記

41. fork [fɔrk] 叉子

42. Friday [\`fraıde] 星期五;週五

43. frisbee [\`frızbi] 飛盤

44. garden [\`gɑrdn] 花園;從事園藝

45. get [gɛt] 取得;得到;拿

46. glad [glæd] 高興的;樂意的

47. goat [got] 山羊

48. gym [dʒım] 體育館

49. hard [hɑrd] 困難的/努力地

50. hate [het] 討厭/恨

51. hear [hır] 聽

52. high [haı] 高(的)

53. him [hım] 他(受格)

54. hop [hɑp] 跳

55. hope [hop] 希望

56. hotel [ho\`tɛl] 旅館

57. housewife [\`haʊswaıf] 家庭主婦

58. husband [\`hʌzbənd] 丈夫

59. large [lɑrdʒ] 大的

60. last [læst] 最後的/上一個

61. left [lɛft] 左(邊)

62. lesson [\`lɛsən] 課程

63. lucky [\`lʌki] 幸運的

64. many [\`mɛni] 很多(的);許多(的)

65. marker [\`mɑrkər] 馬克筆;麥克筆

66. me [mi] 我(受格)

67. meet [mit] 遇見;碰見

68. Monday [\`mʌnde] 星期一

69. monkey [\`mʌŋki] 猴子

70. more [mɔr] 更多的;較多的

71. mother [\`mʌðər] 母親;媽媽 mom [mɑm] / mommy[\`mɑmi]

72. motorcycle [\`motər\`saıkəl] 機車;摩托車

73. mountain [\`maʊntən] 山

74. mouth [maʊθ] 嘴

75. much [mʌtʃ] 很多

76. music [\`mjuzık] 音樂

77. near [nır] 靠近/在...附近

78. night [naıt] 晚上

79. noon [nun] 中午

80. number [\`nʌmbər] 數字

81. nurse [nɜrs] 護士

82. often [\`ɔfən] 常常;時常

83. once [wʌns] 一次/一旦

84. only [\`onli] 僅;只(有)

85. open [\`opən] 打開/開的/營業

86. orange [\`ɔrındʒ] 橘色(的)/柳丁

87. order [\`ɔrdər] (動)點餐/(名)次序

88. other [\`ʌðər] 其他的

89. outside [aʊt\`saıd] (在...)外面

90. over [\`ovər] 在~之上

91. pants [pænts] 長褲

92. parent [\`perənt] 雙親之中的父或母

93. party [\`pɑrti] 派對;宴會

94. pass [pæs] 通過;經過

95. past [pæst] 過去的

96. people [\`pipəl] 人們

97. person [\`pɜrsən] 人(單數)

98. photo [\`foto] 照片;相片

99. pick [pık] 挑;揀;選

100. pin [pın] 別針/大頭針

101. pizza [\`pitsə] 比薩;披薩

102. place [ples] 地方

103. plan [plæn] 計畫

104. pool [pul] 池子

105. practice [\`præktɪs] 練習

106. pray [pre] 祈禱

107. prepare [prı\`per] 準備

108. present [\`prɛznt] 禮物 [prı\`zɛnt] 呈現

109. price [praıs] 價錢

110. problem [\`prɑbləm] 問題

111. pull [pʊl] 拉

112. puppy [\`pʌpi] 幼犬;小狗

113. purple [\`pɜrpəl] 紫色(的)

114. push [pʊʃ] 推

115. queen [kwin] 皇后

116. question [\`kwɛstʃən] 問題;題目

117. quick [kwık] 快的;迅速的

118. rabbit [\`ræbɪt] 兔子

119. radio [\`redio] 收音機/廣播

120. rain [ren] 雨/下雨

121. rainy [\`reni] 有雨的;雨天的

122. remember [rı\`mɛmbər] 記住;記得

123. right [raıt] 右/對的/正是;就是

124. robot [\`robɑt] 機器人

125. rope [rop] 繩子

126. row [ro] 排;划船

127. safe [sef] 安全的;平安的

128. Saturday [\`sætərde] 星期六

129. scared [skerd] 感到害怕的

130. school [skul] 學校

131. second [\`sɛkənd] 第二個(的);秒

132. seed [sid] 種子

133. seldom [\`sɛldəm] 很少;不常

134. senior high school [\`sinjər haı skul] 高中

135. several [\`sɛvərəl] 幾個;數個

136. shark [ʃɑrk] 鯊魚

137. shoe(s) [ʃu] 鞋(子)

138. shout [ʃaʊt] 吶喊;大叫

139. snowman [\`snomæn] 雪人

140. sometimes [\`sʌmtaımz] 有時候

141. sorry [\`sɔri] 感到抱歉/悲傷/遺憾的

142. spoon [spun] 湯匙

143. stamp [stæmp] 郵票;踩踏;戳記

144. Sunday [\`sʌnde] 星期日

145. surf [sɜrf] 瀏覽(網路)/衝浪

146. Taiwan [taı\`wɑn] 臺灣

147. taxi [\`tæksi] 計程車

148. teach [titʃ] 教(學)

149. tell [tɛl] 告訴

150. tennis [\`tɛnɪs] 網球

151. test [tɛst] 考試/測驗

152. the [ðə, ði] 這/那/這些/那些 (定冠詞)

153. them [ðɛm] 他們(受格)

154. third [θɜrd] 第三的

155. Thursday [\`θɜrzde] 星期四

156. ticket [\`tıkɪt] 票

157. tiger [\`taıgər] 老虎

158. to [tu, tə] 給/往/到/向

159. tonight [tə\`naıt] 今晚

160. town [taʊn] 城鎮

161. Tuesday [\`tjuzde] 星期二

162. understand [ʌndər\`stænd] 了解;明白

163. unhappy [ʌn\`hæpi] 不高興的;不開心的

164. us [ʌs] 我們(受格)

165. usually [\`juʒuəli] 通常

166. waiter [\`wetər] 男侍者;男服務生

167. waitress [\`wetrəs] 女侍者;女服務生

168. was [wʌz, wəz] 是(am及is的過去式)

169. watch [wɑtʃ] 手錶/觀賞;看

170. Wednesday [\`wɛnzde] 星期三

171. welcome [\`wɛlkəm] 受歡迎的;歡迎光臨

172. well [wɛl] 好的;嗯;井;安康的

173. were [wɜr, wər] 是(are的過去式)

174. wife [waıf] 太太;妻子

175. win [wın] 贏

176. windy [\`wɪndi] 有風的

177. yard [jɑrd] 院子;碼

178. your [jʊr, jɔr] 你的/你們的

179. away [ə\`we] 遠離

180. back [bæk] 回來;回到/後面/背面

181. bake [bek] 烘;烤

182. basket [\`bæskɪt] 籃子

183. did [dıd] 做(過去式)

184. driver [\`draıvər] 司機;駕駛

185. hundred [\`hʌndrəd] 百

186. hurry [\`hɜri] 匆忙;催促

187. repeat [rı\`pit] 重複

188. ride [raıd] 騎;乘

189. skate [sket] 溜冰/溜冰鞋

190. smile [smaıl] 微笑

`;

        const rawLevel6Vocab = `

1. age [edʒ] 年齡/年紀;衰老

2. agree [ə\`gri] 同意

3. airplane [\`erplen] 飛機

4. airport [\`erpɔrt] 機場

5. also [\`ɔlso] 也/同時;並且

6. angry [\`æŋgri] 生氣(的)

7. another [ə\`nʌðər] 另一個

8. apartment [ə\`pɑrtmənt] 公寓

9. April [\`eprəl] 四月

10. artist [\`ɑrtɪst] 美術家/藝術家

11. August [\`ɔgəst] 八月

12. bakery [\`bekəri] 麵包店

13. baseball [\`besbɔl] 棒球

14. basketball [\`bæskɪtbɔl] 籃球

15. bath [bæθ] (n.)洗澡;沐浴

16. bathroom [\`bæθrum] 浴室

17. beach [bitʃ] 海灘

18. beautiful [\`bjutəfəl] 美麗(的)

19. because [bı\`kɔz] 因為

20. bedroom [\`bɛdrum] 臥室;臥房

21. believe [bı\`liv] 相信

22. between [bı\`twin] 在...之間

23. blanket [\`blæŋkɪt] 毯子;毛毯

24. blow [blo] 吹

25. boat [bot] 小船

26. borrow [\`bɔro] 借(入)

27. boss [bɔs] 老板;老闆

28. bottle [\`bɑtəl] 瓶子

29. bottom [\`bɑtəm] 底部

30. bun [bʌn] 小圓麵包

31. camera [\`kæmərə] 照相機

32. camp [kæmp] 露營

33. care [ker] 照顧/關心

34. cent [sɛnt] 分;一分錢

35. chance [tʃæns] 機會;碰巧的;冒險

36. cheap [tʃip] 便宜的;卑劣的

37. cheese [tʃiz] 乳酪;起司

38. China [\`tʃaınə] 中國

39. chocolate [\`tʃɔkəlɪt] 巧克力

40. Christmas [\`krɪsməs] 聖(耶)誕節

41. church [tʃɜrtʃ] 教堂

42. clap [klæp] 拍手;鼓掌;拍擊

43. clean [klin] 清掃;打掃;清理;乾淨的

44. clerk [klɜrk] 店員;職員;銷售員

45. climb [klaım] 爬;攀爬

46. club [klʌb] 社團;俱樂部

47. cold [kold] (寒)冷的/冷酷的/感冒

48. comb [kom] 梳理/梳子

49. comfortable [\`kʌmfərtəbəl] 舒服(的);舒適(的)

50. convenient [kən\`vinjənt] 方便(的);便利(的)

51. corner [\`kɔrnər] 角落

52. cost [kɔst] 花費/價值;費用

53. couch [kaʊtʃ] 長沙發;躺椅

54. count [kaʊnt] 數

55. cousin [\`kʌzən] 堂(表)兄弟姐妹

56. crazy [\`krezi] 發狂的/瘋了;著迷的

57. dead [dɛd] 死亡的;枯死的;失效的

58. deaf [dɛf] 耳(聾)的

59. deal [dil] 處理;交易

60. December [dı\`sɛmbər] 十二月

61. decide [dı\`saıd] 決定

62. department store [dı\`pɑrtmənt stɔr] 百貨公司

63. dictionary [\`dıkʃəneri] 字典

64. different [\`dıfərənt] 不同(的);不一樣(的)

65. doctor [\`dɑktər] (Dr.)醫生/博士

66. dodge ball [\`dɑdʒ bɔl] 躲避球

67. dot [dɑt] 點;小圓點

68. dragon [\`drægən] 龍

69. drawer [drɔr] 抽屜

70. drum [drʌm] 鼓

71. during [\`djʊrɪŋ] 在...期間(內)

72. earth [ɜrθ] 地球;陸地;地面;土

73. east [ist] 東(方)

74. Easter [\`istər] 復活節

75. either [\`iðər] 也...(不)

76. elementary school [ɛlə\`mɛntəri skul] 國小;小學

77. else [ɛls] 其他的

78. e-mail [\`imeɪl] 電子郵件

79. end [ɛnd] 結束

80. enter [\`ɛntər] 進入

81. eve [iv] 前夕

82. example [ıg\`zæmpəl] 例子

83. fact [fækt] 事實

84. factory [\`fæktəri] 工廠

85. famous [\`feməs] 有名的

86. far [fɑr] 遠(的)

87. farmer [\`fɑrmər] 農夫

88. favorite [\`fevərɪt] 最喜歡(愛)的

89. February [\`fɛbruɛri] 二月

90. few [fju] 很少

91. fight [faıt] 打架/吵架;打仗;對抗

92. fill [fıl] (裝)填

93. finally [\`faınəli] 最後;終於

94. finger [\`fıŋgər] 手指(頭)

95. finish [\`fınıʃ] 完成

96. fisherman [\`fıʃərmən] 漁夫

97. fix [fıks] 修理/固定;解決

98. floor [flɔr] 樓層/地板

99. follow [\`fɑlo] 跟隨/遵循

100. front [frʌnt] 前面...(的)

101. fun [fʌn] 樂趣/有趣的

102. gate [get] 大門;出入口

103. gift [gıft] 禮物;天賦

104. glass [glæs] 玻璃/玻璃杯

105. glove [glʌv] 手套

106. goose [gus] 鵝

107. grape [grep] 葡萄

108. hamburger [\`hæmbɜrgər] 漢堡

109. happen [\`hæpən] 發生

110. health [hɛlθ] 健康

111. heart [hɑrt] 心/心臟

112. heavy [\`hɛvi] 重的/肥胖的

113. helpful [\`hɛlpfəl] 有幫助的/有用的

114. her [hɜr] 她的(所有格)

115. hide [haıd] 躲;藏;躲藏

116. hike [haık] 健行;徒步旅行

117. his [hız] 他的(所有格)

118. history [\`hıstəri] 歷史

119. hobby [\`hɑbi] 嗜好

120. holiday [\`hɑləde] 假(日);假期

121. hospital [\`hɑspɪtəl] 醫院;養育院

122. idea [aı\`diə] 注意;點子;想法

123. important [ım\`pɔrtənt] 重要的

124. insect [\`ınsɛkt] 昆蟲

125. inside [ın\`saıd] (在)裡面

126. jacket [\`dʒækɪt] 夾克

127. January [\`dʒænjuɛri] 一月

128. July [dʒu\`laı] 七月

129. June [dʒun] 六月

130. kangaroo [kæŋgə\`ru] 袋鼠

131. knife [naıf] 刀子

132. know [no] 認識/知道

133. koala [ko\`ɑlə] 無尾熊

134. late [let] 遲的;晚的;晚地

135. lazy [\`lezi] 懶(惰)的

136. lemon [\`lɛmən] 檸檬

137. let [lɛt] 讓~

138. library [\`laıbrɛri] 圖書館

139. like [laık] (動)喜歡/(介)像~

140. lip [lıp] (嘴)唇

141. listen [\`lısən] 聽;傾聽

142. little [\`lıtəl] 少的/小的(年紀)

143. live [lıv] (居)住/生存

144. living  room [\`lıvıŋ rum] 客廳;起居室

145. loud [laʊd] 大聲的

146. lovely [\`lʌvli] 可愛的

147. low [lo] 低的

148. mailman [\`melmæn] 郵差 mail carrier [\`mel\`kæriər]

149. map [mæp] 地圖

150. March [mɑrtʃ] 三月

151. market [\`mɑrkɪt] 市場

152. mathematics [mæθə\`mætɪks] 數學 math [mæθ]

153. May [me] 五月

154. maybe [\`mebi] 也許

155. meeting [\`mitɪŋ] 會議

156. minute [\`mınɪt] 分鐘

157. month [mʌnθ] 月份

158. most [most] 大部分(的);多數(的)

159. MRT 捷運 mass [mæs] 大眾的 rapid [\`ræpɪd] 快速的 transit [\`trænsɪt] 運輸

160. museum [mju\`ziəm] 博物館

161. must [mʌst] 必須

162. my [maı] 我的(所有格)

163. nail [nel] 指甲

164. noodle [\`nudəl] 麵(條)

165. north [nɔrθ] 北(方)

166. November [no\`vɛmbər] 十一月

167. papaya [pə\`paıə] 木瓜

168. peach [pitʃ] 桃子;告密

169. pear [per] 梨子;西洋梨

170. piano [pi\`æno] 鋼琴

171. plate [plet] 盤子;碟;版塊

172. pocket [\`pɑkɪt] 口袋

173. pond [pɑnd] 池塘;水窪

174. popcorn [\`pɑpkɔrn] 爆米花

175. post  office [\`post\`ɔfɪs] 郵局

176. postcard [\`postkɑrd] 明信片

177. purse [pɜrs] 皮包(女用)

178. put [pʊt] 放(置)

179. quiet [\`kwaıət] 安靜的

180. rat [ræt] 田鼠;家鼠;卑鄙之人(鼠輩)

181. ready [\`rɛdi] 準備好的

182. restroom [\`rɛstrum] 洗手間

183. roller skate [\`rolər sket] (四)輪式溜冰鞋

184. round [raʊnd] 圓的

185. sale [sel] 賣;販售;出售(名)

186. science [\`saıəns] 科學

187. sell [sɛl] 賣;販售;出售(動)

188. September [sɛp\`tɛmbər] 九月

189. shake [ʃek] 震盪;搖晃

190. shape [ʃep] 形狀;外型

191. share [ʃer] 分享/分擔

192. shopkeeper [\`ʃɑpkipər] 店主;店家

193. shorts [ʃɔrts] 短褲

194. sick [sık] 生病的/噁心的

195. side [saıd] 邊;側邊的

196. snowy [\`snoi] 下雪的;有雪的

197. south [saʊθ] 南方(的)

198. space [spes] 空間/太空

199. special [\`spɛʃəl] 特別的;特殊的

200. spider [\`spaıdər] 蜘蛛

201. story [\`stɔri] 故事/層(樓)

202. strawberry [\`strɔbɛri] 草莓

203. sweater [\`swɛtər] 毛衣

204. tail [tel] 尾巴

205. their [ðer] 他們的(所有格)

206. thick [θık] 厚的/濃的

207. thin [θın] 薄的;瘦的

208. thing [θıŋ] 事情/東西

209. tie [taı] 領帶/綁

210. tired [taırd] 疲倦的

211. toast [tost] 土司

212. tomato [tə\`meto] 蕃茄

213. tooth [tuθ] 牙齒(單數)

214. trash [træʃ] 垃圾

215. T-shirt [\`tiʃɜrt] T恤(圓領襯衫)

216. turkey [\`tɜrki] 火雞

217. turtle [\`tɜrtəl] 烏龜

218. umbrella [ʌm\`brɛlə] 雨傘

219. useful [\`jusfəl] 有用的

220. vest [vɛst] 背心

221. video [\`vɪdio] 錄影帶

222. voice [vɔıs] 聲音

223. wallet [\`wɑlɪt] 皮夾(男用)

224. weak [wik] 弱的;虛弱的

225. west [wɛst] 西方(的)

226. will [wıl] 將

227. wish [wıʃ] 但願;希望;願望

228. workbook [\`wɜrkbʊk] 習作(簿)

229. would [wʊd] 願;將(will的過去式)

230. art [ɑrt] 美術/藝術

231. guava [\`gwɑvə] 番石榴;芭樂

232. guitar [gı\`tɑr] 吉他

233. habit [\`hæbɪt] 習慣

234. maybe [\`mebi] 也許

235. October [ɑk\`tobər] 十月

236. oil [ɔıl] 油

237. our [aʊr] 我們的(所有格)

238. ox [ɑks] 公牛(單數)公寓

239. rose [roz] 玫瑰

`;

        const rawLevel7Vocab = `

1. across [ə\`krɔs] 穿越;穿過

2. action [\`ækʃən] 行動;動作

3. actor [\`æktər] 男演員

4. almost [\`ɔlmost] 幾乎;差不多

5. around [ə\`raʊnd] 在...四周環繞

6. avoid [ə\`vɔıd] 避開/閃躲/避免

7. badminton [\`bædmɪntən] 羽毛球

8. band [bænd] 樂團;樂隊

9. bat [bæt] 蝙蝠/球棒

10. bear [ber] 熊/出生/忍受

11. been [bın] 是(be動詞的過去分詞)

12. behind [bı\`haınd] 在...後面

13. bell [bɛl] 鈴/鐘

14. belt [bɛlt] 皮帶;腰帶

15. bench [bɛntʃ] 長凳;長椅

16. beside [bı\`saıd] 在...旁邊

17. bite [baıt] 咬

18. blackboard [\`blækbɔrd] 黑板

19. bored [bɔrd] 感到無聊的

20. boring [\`bɔrıŋ] 令人無聊的

21. born [bɔrn] 出生/天生的

22. bowl [bol] 碗

23. bring [brıŋ] 帶來

24. bug [bʌg] 小蟲(子)

25. build [bıld] 建造;建造/蓋

26. business [\`bıznəs] 生意/事業/商業

27. cage [kedʒ] 籠子

28. can [kæn] 能夠;會/罐頭 could[kʊd] 過去式

29. candle [\`kændəl] 蠟燭

30. carry [\`kæri] 帶著;攜帶

31. castle [\`kæsəl] 城堡

32. center [\`sɛntər] 中心

33. cheat [tʃit] 欺騙/作弊

34. check [tʃɛk] 檢查;確認

35. chess [tʃɛs] 西洋棋;國際象棋

36. chopsticks [\`tʃɑpstıks] 筷子

37. clear [klır] 清楚的;清澈的

38. clothes [kloðz] 衣服

39. collect [kə\`lɛkt] 收集;蒐集

40. comic [\`kɑmık] (連環)漫畫(的)/喜劇的

41. country [\`kʌntri] 鄉下/國家

42. course [kɔrs] 課程/科目

43. dangerous [\`dendʒərəs] 危險(的)

44. dentist [\`dɛntɪst] 牙醫

45. done [dʌn] 做

46. dozen [\`dʌzən] 一打

47. dream [drim] 夢;作夢夢想;理想

48. drop [drɑp] 掉(落)/滴落

49. ever [\`ɛvər] 曾經

50. excited [ık\`saıtəd] (感到)興奮的

51. exciting [ık\`saıtıŋ] (令人)興奮的/刺激的

52. full [fʊl] 滿的/飽的

53. future [\`fjutʃər] 未來

54. game [gem] 遊戲/比賽

55. garbage [\`gɑrbıdʒ] 垃圾

56. ghost [gost] 鬼

57. glasses [\`glæsəz] 眼鏡/玻璃杯(複數)

58. gram [græm] 克;公克

59. grass [græs] 草;草皮;草地

60. grow [gro] 成長/種植

61. guess [gɛs] 猜;猜想;猜測

62. guy [gaı] 傢伙;小夥子/人

63. excuse [ık\`skjus] 藉口/原諒

64. exercise [\`ɛksərsaız] 運動/練習題

65. French  fries [frɛntʃ fraız] 薯條

66. Halloween [hælo\`in] 萬聖節前夕

67. handsome [\`hænsəm] 英俊的

68. happy [\`hæpi] (感到)高興的;樂意的

69. hard-working [hɑrd\`wɜrkıŋ] 勤奮地;勤勉地

70. healthy [\`hɛlθi] 健康的

71. hers [hɜrz] 她的東西(所有格代名詞)

72. hold [hold] 緊握;舉行

73. honey [\`hʌni] 心愛的人

74. hunt [hʌnt] 打獵

75. inch [ıntʃ] 英吋;吋

76. interest [\`ıntrəst] 興趣

77. interested [\`ıntrəstəd] 對...興趣的

78. interesting [\`ıntrəstıŋ] (令人覺得)有趣的

79. island [\`aılənd] 島(嶼)

80. itself [ıt\`sɛlf] 它自己

81. jeans [dʒinz] 牛仔褲

82. joy [dʒɔı] 喜悅;歡樂

83. jump [dʒʌmp] 跳

84. junior high school [\`dʒunjər haı skul] 國民中學

85. just [dʒʌst] 僅;只/剛(剛)

86. keep [kip] 持續;繼續/保持

87. key [ki] 鑰匙/關鍵

88. kill [kıl] 殺

89. kilogram [\`kıləgræm] 公斤

90. knee [ni] 膝(蓋)

91. knock [nɑk] 敲(打)

92. lake [lek] 湖

93. lamp [læmp] 檯燈

94. land [lænd] 陸地

95. lantern [\`læntərn] 燈;燈籠

96. later [\`letər] 待會兒/...之後

97. laugh [læf] (大)笑

98. leader [\`lidər] 領導者

99. lend [lɛnd] 借出

100. letter [\`lɛtər] 信/字母

101. lid [lıd] 蓋子

102. life [laıf] 生命/生活

103. list [lıst] 清單/列出

104. look [lʊk] 看起來/注視

105. lose [luz] 輸/失去

106. machine [mə\`ʃin] 機器

107. mail [mel] 郵件/郵寄

108. mask [mæsk] 面具/口罩

109. mat [mæt] 墊子;席子

110. matter [\`mætər] 事件;事情;有關係

111. may [me] 也許;可能 might [maıt] ;可以

112. menu [\`mɛnju] 菜單

113. mile [maıl] 英哩/哩

114. million [\`mıljən] 百萬

115. mistake [mı\`stek] 錯誤

116. moment [\`momənt] 時刻

117. mouse [maʊs] 老鼠/滑鼠

118. mud [mʌd] 泥巴;泥土

119. myself [maı\`sɛlf] 我自己(反身代名詞)

120. nature [\`netʃər] 自然

121. neighbor [\`nebər] 鄰居

122. next [nɛkst] 緊鄰的;下次

123. nobody [\`nobɑdi] 沒人/沒沒無聞的人

124. nod [nɑd] 點頭

125. noise [nɔız] 噪音/聲響

126. notebook [\`notbʊk] 筆記本/筆記型電腦

127. nothing [\`nʌθıŋ] 沒事/沒東西

128. ours [aʊrz] 我們的(所有格代名詞)

129. park [pɑrk] 公園/停車

130. PE 體育(課) physical [\`fızıkəl] 身體的 education [ɛdʒu\`keʃən]教育

131. pipe [paıp] 笛子/管子

132. playground [\`plegraʊnd] 操場;遊戲場戰場;

133. possible [\`pɑsəbəl] 可能的

134. pound [paʊnd] 磅

135. prince [prıns] 王子

136. princess [\`prınsəs] 公主

137. prize [praız] 獎品/獎賞

138. railway [\`relwe] 鐵路;鐵道

139. rainbow [\`renbo] 彩虹

140. recorder [rı\`kɔrdər] 錄音機

141. refrigerator [rı\`frıdʒəretər] 冰箱

142. reporter [rı\`pɔrtər] 記者

143. rise [raız] 上升;升起

144. river [\`rıvər] 河;河流

145. rock [rɑk] 岩石

146. screen [skrin] 螢幕

147. seat [sit] 座位/位子

148. seesaw [\`sisɔ] 蹺蹺版

149. sharp [ʃɑrp] 銳利的

150. shop [ʃɑp] 店/商店

151. should [ʃʊd] 應該

152. shoulder [\`ʃoldər] 肩膀

153. show [ʃo] 秀;節目;呈現;顯示

154. sidewalk [\`saıdwɔk] 人行道

155. simple [\`sımpəl] 簡單的

156. since [sıns] 自從

157. someone [\`sʌmwʌn] / somebody [\`sʌmbɑdi] 某人;有人

158. something [\`sʌmθıŋ] 某事(物)

159. somewhere [\`sʌmwer] 某處

160. spend [spɛnd] 花(費)

161. strange [strendʒ] 奇怪的/陌生的

162. stupid [\`stupɪd] 笨的;愚蠢的

163. surprised [sər\`praızd] 感到驚喜的

164. swing [swıŋ] 搖擺/鞦韆

165. team [tim] 隊伍/球隊

166. teenager [\`tinedʒər] 青少年

167. terrible [\`tɛrəbəl] 可怕的

168. than [ðæn] 比

169. theirs [ðerz] 他們的(所有格代名詞)

170. think [θıŋk] 認為;想

171. though [ðo] / although [ɔl\`ðo] 雖然

172. thousand [\`θaʊzənd] 千

173. total [\`totəl] 總數

174. towel [\`taʊəl] 毛巾

175. tower [\`taʊər] 塔

176. traffic [\`træfɪk] 交通

177. trouble [\`trʌbəl] 麻煩

178. twice [twaıs] 兩次

179. typhoon [taı\`fun] 颱風

180. until [ən\`tıl] 直到

181. violin [vaıə\`lın] 小提琴

182. wake [wek] 叫醒;喚醒/醒來

183. way [we] 方法/道路

184. without [wı\`ðaʊt] 沒有

185. world [wɜrld] 世界

186. yet [jɛt] 還;尚

187. yours [jʊrz] 你的;你們的

188. yourself [jʊr\`sɛlf] 你自己

189. zebra [\`zibrə] 斑馬

190. find [faınd] 發現/找到

191. flute [flut] 橫笛;笛(子)

192. foot [fʊt] 腳/英呎

193. jump [dʒʌmp] (雙腳)跳

194. may [me] 也許;可能/可以 might [maıt]

195. meal [mil] 一餐

196. mean [min] 意指;意思是

197. meat [mit] 肉(類)

198. medicine [\`mɛdəsən] 藥

199. throw [θro] 投,擲,拋,扔

200. time [taım] 時間

`;

        const rawLevel8Vocab = `

1. able [\`ebəl] 有能力的/可能的

2. above [ə\`bʌv] 在...上面

3. abroad [ə\`brɔd] 在...國外

4. act [ækt] 行動/扮演

5. actress [\`æktrəs] 女演員

6. ahead [ə\`hɛd] 向前;往前

7. along [ə\`lɔŋ] 沿著/一起

8. already [ɔl\`rɛdi] 已經

9. American [ə\`mɛrıkən] 美國人/美國(人)的

10. appear [ə\`pır] 出現

11. arrive [ə\`raıv] 到達

12. as [æz] 當做/像;如同

13. attack [ə\`tæk] 攻擊

14. aunt [ænt] 姨媽/姑媽/嬸婆/伯母

15. balcony [\`bælkəni] 陽台;露台

16. bank [bæŋk] 銀行/河岸

17. barbecue [\`bɑrbɪkju] 烤肉

18. base [bes] 基部

19. bean [bin] 豆子;豆莢

20. belong [bı\`lɔŋ] 屬於

21. below [bı\`lo] 在...下面

22. bless [blɛs] 為...祝福

23. boil [bɔıl] 煮沸;沸騰

24. book [bʊk] 書/登記/預定

25. bow [baʊ] 鞠躬(動詞) [bo] 弓(名詞)

26. break [brek] 打破/弄斷/弄壞

27. bridge [brıdʒ] 橋(樑)

28. bright [braıt] 明亮的;光亮的

29. brush [brʌʃ] 刷;刷洗/梳/梳子

30. burn [bɜrn] 燃燒/燒焦

31. businessman [\`bıznəsmæn] 生意人

32. butterfly [\`bʌtərflaı] 蝴蝶

33. by [baı] 在...旁邊/藉著;經由/搭;乘/被

34. call [kɔl] 打電話/呼喚

35. case [kes] 箱/盒/情形/案件

36. celebrate [\`sɛləbret] 慶祝

37. centimeter [\`sɛntəmitər] 公分

38. change [tʃendʒ] 改變/零錢

39. cheer [tʃır] 歡呼/振作

40. Chinese [tʃaı\`niz] 中文/中國人/中國(人)的

41. choose [tʃuz] 選擇

42. circle [\`sɜrkəl] 圓(形);圈出來

43. common [\`kɑmən] 共同的/一般的/普遍的

44. cool [kul] 涼爽(的)/冷靜(的)/酷

45. copy [\`kɑpi] 複製/抄寫/模仿

46. correct [kə\`rɛkt] 正確的/訂正

47. cover [\`kʌvər] 覆蓋/封面

48. cross [krɔs] 橫過;通過/十字架

49. dark [dɑrk] 黑的;暗的;黑暗的/深的

50. dumpling [\`dʌmplıŋ] (有肉餡的)湯圓;麵團

51. engineer [ɛndʒə\`nır] 工程師

52. envelope [\`ɛnvəlop] 信封

53. excellent [\`ɛksələnt] 優秀的/好極了

54. except [ık\`sɛpt] 除了...之外

55. expensive [ık\`spɛnsɪv] (昂)貴的

56. experience [ık\`spırıəns] 經驗/經歷

57. fail [fel] 失敗/不及格

58. fan [fæn] (運動、電影...)迷/扇子

59. festival [\`fɛstəvəl] 節慶;節日

60. fever [\`fivər] 發燒

61. for [fɔr] 為了/由於/有...之久

62. foreign [\`fɔrən] 外國的

63. foreigner [\`fɔrənər] 外國人

64. free [fri] 自由的/空閒的/免費的

65. fresh [frɛʃ] 新鮮(的)

66. fry [fraı] 炸;煎/炒

67. funny [\`fʌni] 可笑的/滑稽的

68. gas [gæs] 瓦斯/汽油

69. giant [\`dʒaıənt] 巨人/巨大的

70. grade [gred] 成績/年級

71. ground [graʊnd] 地面

72. group [grup] 團體/群

73. half [hæf] 一半/30分鐘

74. hang [hæŋ] 懸掛

75. have [hæv] 有/吃/喝/(has,had)使(人)...

76. headache [\`hɛdek] 頭痛

77. heat [hit] 熱/熱度;熱氣/加熱

78. herself [hɜr\`sɛlf] 她自己(反身代名詞)

79. hill [hıl] 山丘;小山丘

80. himself [hım\`sɛlf] 他自己(反身代名詞)

81. hit [hıt] 擊中;碰撞;撞擊;侵襲

82. honest [\`ɑnɪst] 誠實的

83. however [haʊ\`ɛvər] 然而;可是;不過

84. hurt [hɜrt] 傷害/痛

85. if [ıf] 假如;如果/是否

86. Internet [\`ıntərnɛt] (網際)網路

87. interview [\`ıntərvju] 面試

88. kind [kaınd] 親切的/善良的;仁慈的/種類

89. knowledge [\`nɑlɪdʒ] 知識

90. language [\`læŋgwɪdʒ] 語言

91. lawyer [\`lɔjər] 律師

92. lead [lid] 領導;帶領

93. least [list] 最少的/最不

94. leave [liv] 離開/留下;遺留

95. less [lɛs] 較少的/較不

96. lettuce [\`lɛtɪs] 萵苣

97. lie [laı] 說謊;躺

98. light [laıt] (電)燈/光/輕的/淡的/亮的

99. line [laın] 線/條//隊伍

100. lonely [\`lonli] 寂寞的;孤獨的

101. mad [mæd] 發瘋(的)/生氣(的)

102. magic [\`mædʒɪk] 魔術/神奇的

103. make [mek] 製造;做/讓

104. mark [mɑrk] (名)記號;分數(動)做記號;批閱

105. married [\`mærid] 已婚的

106. medium [\`midiəm] 中等的/中號的五分/熟的

107. mind [maınd] (名)心智/(動)介意;注意

108. mine [maın] 我的(所有格代名詞)

109. miss [mɪs] 遺失/錯過/想念

110. modern [\`mɑdərn] 現代(化)的;摩登(的)

111. mop [mɑp] 拖地/拖把

112. move [muv] 移動;搬動/搬家

113. national [\`næʃənəl] 國家的/國立的

114. note [not] 字條;便條/筆記

115. notice [\`notɪs] 注意到

116. off [ɔf] 離開

117. officer [\`ɔfɪsər] 軍官/長官/公務員

118. ourselves [aʊr\`sɛlvz] 我們自己(反身代名詞)

119. own [on] 自己的/擁有

120. pack [pæk] (n.)背包(V.)打包

121. package [\`pækɪdʒ] 包裹

122. paint [pent] 畫畫;著色;油漆

123. pair [per] 雙;對;副

124. paste [pest] 貼/黏/糊狀物

125. perhaps [pər\`hæps] 或許;大概;也許

126. piece [pis] 一塊;一張;一則;碎片

127. planet [\`plænɪt] 星球;行星

128. plant [plænt] 植物;種植

129. play [ple] 玩/打(球)/彈奏(樂器)/遊戲比賽/戲劇

130. player [\`pleər] 選手;運動員/玩家

131. pleasure [\`plɛʒər] 榮幸/愉悅

132. point [pɔınt] 點/分數/重點/指著

133. police [pə\`lis] 警方

134. polite [pə\`laıt] 有禮貌的

135. poor [pʊr] (貧)窮的/拙劣的;差的/可憐的

136. popular [\`pɑpjələr] 流行的/受歡迎的

137. pot [pɑt] 鍋/壺/盆

138. power [\`paʊər] 力量/權力/電力

139. pretty [\`prɪti] 漂亮的/相當地

140. program [\`progræm] 節目/程式

141. proud [praʊd] 感到得意的;自豪的/驕傲的

142. public [\`pʌblɪk] 公共的;公眾的;公開的;公立的

143. pumpkin [\`pʌmpkɪn] 南瓜

144. quarter [\`kwɔrtər] 一刻;十五分鐘/四分之一

145. quite [kwaıt] 相當地

146. quiz [kwɪz] (隨堂)小考

147. race [res] 速度競賽

148. raise [rez] 舉起;抬起

149. rest [rɛst] 休息;剩下的(東西)

150. rich [rɪtʃ] 富有的;有錢的/豐富的

151. ring [rıŋ] 戒指/環;圈

152. roll [rol] 翻滾/捲

153. roller blade [\`rolər bled] 直排輪

154. rule [rul] 規則/統治(V.)

155. sail [sel] 帆/航行

156. salesman [\`selzmən] 業務員;推銷員

157. save [sev] 拯救/節省/存

158. scooter [\`skutər] 輕型機車

159. secretary [\`sɛkrə\`tɛri] 秘書

160. sentence [\`sɛntəns] 句子

161. serious [\`sırıəs] 嚴重的/認真的;嚴肅的

162. set [sɛt] 設立/固定/(一)組

163. shall [ʃæl] 將/應該

164. shine [ʃaın] 發光;照耀

165. sight [saıt] 視力/視野

166. sign [saın] 記號;符號/告示;牌子/簽名

167. slide [slaıd] 滑動;滑行/溜滑梯

168. slim [slım] 苗條的;纖細的

169. smoke [smok] 抽菸/煙霧

170. soldier [\`soldʒər] 士兵

171. sore [sɔr] 疼痛的;酸痛的

172. spaghetti [spə\`gɛti] 義大利麵

173. square [skwer] 正方形;廣場

174. stairs [sterz] 樓梯

175. stomach [\`stʌmək] 胃

176. straight [stret] 直的/直接的

177. stranger [\`strendʒər] 陌生人

178. straw [strɔ] 吸管/稻草

179. subject [\`sʌbdʒɛkt] 科目/主題

180. successful [sək\`sɛsfəl] 成功的

181. surprise [sər\`praız] 使...驚訝/驚喜

182. take [tek] 搭乘/吃/拿/花費(時間)/拍(照)

183. taste [test] 嚐/嚐起來/品味

184. temple [\`tɛmpəl] 寺廟

185. theater [\`θiətər] 戲院;電影院

186. themselves [ðəm\`sɛlvz] 他們自己(反身代名詞)

187. then [ðɛn] 然後/那麼/那時

188. throat [θrot] 喉嚨

189. tidy [\`taıdi] 整齊的

190. tool [tul] 工具

191. touch [tʌtʃ] 摸;碰觸

192. treat [trit] 請客;款待

193. trick [trık] 詭計/技藝/惡作劇

194. tub [tʌb] 桶/浴盆

195. turn [tɜrn] 輪流/轉(動)

196. type [taıp] 形式/打字

197. uncle [\`ʌŋkəl] 叔叔/伯父/舅舅/姨丈

198. uniform [\`junəfɔrm] 制服

199. watermelon [\`wɔtərmɛlən] 西瓜

200. wave [wev] 海浪/揮動

201. whale [hwel] 鯨魚

202. whether [\`wɛðər] 是否

203. whose [huz] 誰的

204. wise [waız] 明智的/有智慧的

205. yourselves [jʊr\`sɛlvz] 你們自己(反身代名詞)

206. yummy [\`jʌmi] 美味的;好吃的

`;

        // --- DOM Element References ---
        const elements = {
            initialScreen: null, quizScreen: null, finishedScreen: null, reviewModeScreen: null, reviewQuizSelectionScreen: null,
            levelSelectionButtonsContainer: null, errorReviewCountSpan: null, startErrorReviewQuizBtn: null,
            showErrorListBtn: null, clearErrorsInitialBtn: null, initialFeedbackP: null,
            quizProgressTextP: null, questionChineseTextP: null, userInputEl: null,
            submitAnswerBtn: null, quizFeedbackP: null,
            finishedTitleH2: null, finalScoreTextP: null, errorSummaryContainer: null,
            errorSummaryListUl: null, noCumulativeErrorsMsgP: null, finishedFeedbackP: null,
            resetToInitialBtn: null, clearErrorsFinishedBtn: null,
            totalVocabCountTextP: null,
            clearConfirmModal: null, confirmClearBtn: null, cancelClearBtn: null,
            errorListModal: null, errorListModalContentDiv: null, closeErrorListBtn: null,
            appContainer: null,
            startReviewModeBtn: null, reviewLevelSelect: null, reviewRangeSelection: null,
            selectedReviewLevelText: null, reviewRangeButtons: null, reviewVocabListContainer: null,
            selectedReviewRangeText: null, reviewVocabList: null, reviewModeFeedback: null,
            backToInitialFromReviewBtn: null, reviewListLevelText: null,
            startReviewQuizModeBtn: null, reviewQuizLevelSelect: null, reviewQuizRangeSelection: null,
            selectedReviewQuizLevelText: null, reviewQuizRangeButtons: null, reviewQuizModeFeedback: null,
            backToInitialFromReviewQuizBtn: null,
            backFromQuizBtn: null
        };

        // --- State Variables ---
        let vocabByLevel = {};
        let quizWords = [];
        let currentWordIndex = 0;
        let score = 0;
        let quizState = 'initial'; // 'initial', 'ongoing', 'finished', 'review_list', 'review_quiz_selection'
        let cameFromState = 'initial'; 
        let errorStats = [];
        let selectedLevel = null;
        let isLoading = true;
        let quizType = 'level'; // 'level', 'error_review', 'review_range_quiz'
        let currentReviewLevel = null;
        let currentReviewRange = null;
        let currentReviewQuizLevel = null;
        let currentReviewQuizRange = null;

        // --- Helper Functions ---
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        let messageTimeout = null;
        function showUIMessage(element, message, type = 'info', duration = 0) {
            if (!element) {
                return;
            }
            element.innerHTML = ''; 
            const messageDiv = document.createElement('div');
            messageDiv.textContent = message;
            messageDiv.className = `ui-message ui-message-${type}`;
            element.appendChild(messageDiv);

            if (duration > 0) {
                if (messageTimeout) clearTimeout(messageTimeout);
                messageTimeout = setTimeout(() => {
                    if (element.contains(messageDiv)) {
                         element.innerHTML = '';
                    }
                }, duration);
            }
        }
        
        function createPronounceButton(textToSpeak, buttonText = '') {
            const button = document.createElement('button');
            button.className = 'pronounce-btn';
            button.dataset.text = textToSpeak;
            button.title = '發音';
            button.innerHTML = `
                ${buttonText ? `<span class="mr-1">${buttonText}</span>` : ''}
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 inline-block">
                    <path d="M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 001.5 12c0 .898.121 1.768.348 2.595.341 1.24 1.518 1.905 2.66 1.905H6.44l4.5 4.5c.945.945 2.56.276 2.56-1.06V4.06zM18.584 12c0-1.823-.728-3.494-1.903-4.682a.75.75 0 10-1.06 1.06A5.402 5.402 0 0116.999 12c0 .996-.274 1.914-.747 2.662a.75.75 0 101.092 1.028A6.903 6.903 0 0018.583 12z" />
                    <path d="M16.28 7.553a.75.75 0 10-1.06 1.06A3.001 3.001 0 0115.75 12c0 .697-.24 1.334-.645 1.834a.75.75 0 001.084 1.043A4.501 4.501 0 0017.25 12c0-1.28-.523-2.432-1.362-3.29a.75.75 0 10-1.061-1.061z" />
                </svg>`;
            return button;
        }

        function speakText(text) {
            if (text && 'speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                window.speechSynthesis.speak(utterance);
            } else if (!('speechSynthesis' in window)) {
                alert('您的瀏覽器不支援語音合成功能。');
            }
        }

        function parseVocabulary(text, level) {
            const lines = text.trim().split('\n');
            const vocabulary = [];
            let originalIndex = 0;

            lines.forEach(line => {
                if (line.trim() === '' || line.includes('增補單字')) {
                    if (line.includes('增補單字')) originalIndex = 0;
                    return;
                }
                originalIndex++;

                const numMatch = line.match(/^(\d+)\.\s*/);
                if (!numMatch) {
                    return;
                }
                let remainingLine = line.substring(numMatch[0].length); 

                let engPart = "";
                let pronPart = null;
                let chinPart = "";

                const pronMatch = remainingLine.match(/(.*?)\[([^\]]*)\](.*)/);
                if (pronMatch) {
                    engPart = pronMatch[1].trim();
                    pronPart = pronMatch[2].trim();
                    chinPart = pronMatch[3].trim();
                } else {
                    const chineseStartMatch = remainingLine.match(/([^\u4e00-\u9fa5（【「『《]+)([\u4e00-\u9fa5（【「『《].*)/);
                    if (chineseStartMatch) {
                        engPart = chineseStartMatch[1].trim();
                        chinPart = chineseStartMatch[2].trim();
                    } else {
                        engPart = remainingLine.trim(); 
                        chinPart = ""; 
                    }
                }
                
                if (engPart) {
                    engPart = engPart.replace(/\s*\((?:n|v|adj|adv|prep|conj|art|aux|pron|abbr|pl|sing|phr|prep phr|v phr|n phr|int)\.?\s*\)$/i, '').trim();
                    chinPart = chinPart.replace(/^\s*\((?:n|v|adj|adv|prep|conj|art|aux|pron|abbr|pl|sing|phr|prep phr|v phr|n phr|int)\.?\s*\)\s*/i, '').trim();
                } else { 
                    return;
                }

                let englishWord = engPart;
                if (englishWord.includes('/')) {
                    englishWord = englishWord.split('/')[0].trim();
                }
                englishWord = englishWord.replace(/\s*=\s*.*$/, '').trim();
                
                englishWord = englishWord.replace(/\s+\(([^)]+)\)$/, (match, p1) => {
                    if (englishWord.toLowerCase() === "a(an)" && p1.toLowerCase() === "an") return match;
                    if (p1.length <= 2 && /^[a-zA-Z0-9]+$/.test(p1)) return match; 
                    if (p1.length > 2 && !englishWord.toLowerCase().startsWith(match.trim().toLowerCase().substring(1))) {
                        if (!/[\u4e00-\u9fa5]/.test(p1)) return '';
                    }
                    return match; 
                }).trim();

                if (!englishWord) {
                    return;
                }
                if (engPart.toLowerCase().startsWith("a(an)")) englishWord = "a(an)";

                const meanings = chinPart.split(/[/;；，,、\s（(]+\s*/)
                    .map(m => m.replace(/[)）]$/, '').trim()) 
                    .filter(m => {
                        if (!m) return false;
                        if (/^\[.*\]$/.test(m.trim())) return false; 
                        
                        const hasChinese = /[\u4e00-\u9fa5]/.test(m.trim());
                        if (!hasChinese && /^[a-zA-Z0-9\s\-\.`'&]+$/.test(m.trim())) {
                            if (chinPart.trim() === m.trim() && m.length > 10 && !m.match(/\b(of|the|is|are|to|be|for|an|a)\b/i)) { 
                               return false;
                            }
                            if (m.length <=5 && /^[A-Z\.\s]+$/.test(m.trim())) return true; 
                            if (chinPart.includes(m) && chinPart.length > m.length + 3 && m.split(/\s+/).length <= 3) return true; 
                            return false; 
                        }
                        return true; 
                    });

                if (englishWord && meanings.length > 0) {
                    vocabulary.push({
                        id: `level${level}-${englishWord}-${Date.now()}-${Math.random()}`,
                        originalIndex: originalIndex, 
                        english: englishWord,
                        pronunciation: pronPart,
                        chinese: meanings,
                        level: parseInt(level, 10),
                    });
                }
            });
            return vocabulary.filter(v => v.chinese && v.chinese.length > 0 && v.english);
        }


        // --- UI Update Functions ---
        function updateScreenVisibility() {
            elements.initialScreen.style.display = quizState === 'initial' ? 'block' : 'none';
            elements.quizScreen.style.display = quizState === 'ongoing' ? 'block' : 'none';
            elements.finishedScreen.style.display = quizState === 'finished' ? 'block' : 'none';
            elements.reviewModeScreen.style.display = quizState === 'review_list' ? 'block' : 'none';
            elements.reviewQuizSelectionScreen.style.display = quizState === 'review_quiz_selection' ? 'block' : 'none';

            if (quizState === 'initial') {
                updateInitialScreenElements();
            } else if (quizState === 'review_list') {
                populateReviewLevelSelect(); 
            } else if (quizState === 'review_quiz_selection') { 
                populateReviewQuizLevelSelect();
            }
        }
        
        function updateInitialScreenElements() {
            const currentErrorCount = errorStats.filter(stat => stat.errors > 0).length;
            elements.errorReviewCountSpan.textContent = currentErrorCount;

            const buttonsToToggle = [
                { btn: elements.startErrorReviewQuizBtn, activeBg: 'bg-amber-500', hoverBg: 'hover:bg-amber-600' },
                { btn: elements.showErrorListBtn, activeBg: 'bg-teal-500', hoverBg: 'hover:bg-teal-600' }
            ];

            buttonsToToggle.forEach(item => {
                item.btn.disabled = currentErrorCount === 0;
                item.btn.classList.toggle('text-slate-400', currentErrorCount === 0);
                item.btn.classList.toggle('cursor-not-allowed', currentErrorCount === 0);

                item.btn.classList.remove(item.activeBg, item.hoverBg, 'bg-slate-600', 'text-white', 'text-slate-400');
                if (currentErrorCount > 0) {
                    item.btn.classList.add(item.activeBg, item.hoverBg, 'text-white');
                } else {
                    item.btn.classList.add('bg-slate-600', 'text-slate-400');
                }
            });
            
            elements.clearErrorsInitialBtn.style.display = errorStats.length > 0 ? 'block' : 'none';
        }

        function renderLevelSelectionButtons() {
            elements.levelSelectionButtonsContainer.innerHTML = ''; 
            [1, 2, 3, 4, 5, 6, 7, 8].forEach(level => {
                const button = document.createElement('button');
                const levelVocab = vocabByLevel[`level${level}`] || [];
                const isDisabled = levelVocab.length === 0;

                button.key = `level-btn-${level}`;
                button.textContent = `Level ${level}${isDisabled ? " (空)" : ` (${levelVocab.length})`}`;
                button.disabled = isDisabled;
                button.className = `w-full font-semibold py-3 px-2 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105 
                    ${isDisabled 
                        ? 'bg-slate-600 text-slate-400 cursor-not-allowed' 
                        : 'bg-sky-500 hover:bg-sky-600 text-white'}`;
                button.onclick = () => handleLevelSelect(level);
                elements.levelSelectionButtonsContainer.appendChild(button);
            });
        }
        
        function renderQuizQuestion() {
            if (quizWords.length === 0 || currentWordIndex >= quizWords.length) return;
            const word = quizWords[currentWordIndex];
            let progressPrefix = "";
            if (quizType === 'level') {
                progressPrefix = `Level ${selectedLevel}`;
            } else if (quizType === 'error_review') {
                progressPrefix = '錯誤複習';
            } else if (quizType === 'review_range_quiz') { 
                progressPrefix = `範圍測驗 L${selectedLevel} (${currentReviewQuizRange.min}-${currentReviewQuizRange.max === Infinity ? '之後': currentReviewQuizRange.max})`;
            }
            elements.quizProgressTextP.textContent = `${progressPrefix} - 第 ${currentWordIndex + 1} / ${quizWords.length} 題`;
            elements.questionChineseTextP.textContent = word.questionChinese;
            elements.quizFeedbackP.innerHTML = ''; 
            elements.userInputEl.value = '';
            elements.userInputEl.focus();
        }

        function renderFinishedScreen() {
            let titlePrefix = "";
            if (quizType === 'level') {
                titlePrefix = `Level ${selectedLevel} `;
            } else if (quizType === 'error_review') {
                titlePrefix = '錯誤複習 ';
            } else if (quizType === 'review_range_quiz') { 
                 titlePrefix = `範圍測驗 L${selectedLevel} (${currentReviewQuizRange.min}-${currentReviewQuizRange.max === Infinity ? '之後': currentReviewQuizRange.max}) `;
            }
            elements.finishedTitleH2.textContent = `${titlePrefix}測驗結束！`;
            elements.finalScoreTextP.textContent = `你的得分：${score} / ${quizWords.length}`;
            
            const currentActiveErrors = errorStats.filter(stat => stat.errors > 0);

            if (currentActiveErrors.length > 0) {
                elements.errorSummaryContainer.style.display = 'block';
                elements.noCumulativeErrorsMsgP.style.display = 'none';
                elements.errorSummaryListUl.innerHTML = ''; 
                currentActiveErrors
                    .sort((a, b) => b.errors - a.errors)
                    .forEach(stat => {
                        const li = document.createElement('li');
                        li.className = 'p-2 bg-slate-600 rounded-md flex justify-between items-center';
                        const pronounceButtonHTML = createPronounceButton(stat.english).outerHTML;
                        li.innerHTML = `
                            <div>
                                <span class="font-semibold text-amber-300">${stat.english}</span>
                                ${pronounceButtonHTML}
                                <span class="text-slate-200 text-sm ml-1">(${stat.chinese} - L${stat.level || '未知'})</span>
                            </div>
                            <span class="text-red-300 ml-2">(錯誤 ${stat.errors} 次)</span>
                        `;
                        elements.errorSummaryListUl.appendChild(li);
                    });
            } else {
                elements.errorSummaryContainer.style.display = 'none';
                elements.noCumulativeErrorsMsgP.style.display = 'block';
            }
            elements.clearErrorsFinishedBtn.style.display = errorStats.length > 0 ? 'block' : 'none';
        }
        
        // --- Review Mode Functions (List Review) ---
        function startListReviewMode() { 
            quizState = 'review_list';
            currentReviewLevel = null;
            currentReviewRange = null;
            elements.reviewRangeSelection.style.display = 'none';
            elements.reviewVocabListContainer.style.display = 'none';
            elements.reviewModeFeedback.innerHTML = '';
            elements.reviewLevelSelect.value = ""; 
            updateScreenVisibility();
        }

        function populateReviewLevelSelect() {
            elements.reviewLevelSelect.innerHTML = '<option value="">-- 請選擇等級 --</option>';
            for (let i = 1; i <= 8; i++) {
                if (vocabByLevel[`level${i}`] && vocabByLevel[`level${i}`].length > 0) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `Level ${i} (${vocabByLevel[`level${i}`].length} 字)`;
                    elements.reviewLevelSelect.appendChild(option);
                }
            }
        }

        function handleReviewLevelChange(event) { 
            const level = event.target.value;
            currentReviewLevel = level ? parseInt(level) : null;
            elements.reviewVocabListContainer.style.display = 'none'; 
            elements.reviewModeFeedback.innerHTML = '';

            if (currentReviewLevel) {
                elements.selectedReviewLevelText.textContent = currentReviewLevel;
                elements.reviewListLevelText.textContent = currentReviewLevel; 
                elements.reviewRangeSelection.style.display = 'block';
                renderReviewRangeButtons(currentReviewLevel); 
            } else {
                elements.reviewRangeSelection.style.display = 'none';
            }
        }

        function renderReviewRangeButtons(level) { 
            elements.reviewRangeButtons.innerHTML = '';
            const levelVocab = vocabByLevel[`level${level}`] || [];
            const levelVocabCount = levelVocab.length;
            
            if (levelVocabCount === 0) {
                elements.reviewRangeButtons.innerHTML = `<p class="text-slate-400 col-span-full text-center">此等級無詞彙可供選擇區間。</p>`;
                return;
            }

            const rangeSize = 20; 
            let ranges = [];
            let currentMin = 1;

            while (currentMin <= levelVocabCount) {
                let currentMax = currentMin + rangeSize - 1;
                const wordsInThisSpecificRange = levelVocab.filter(v => v.originalIndex >= currentMin && v.originalIndex <= currentMax).length;

                if (wordsInThisSpecificRange > 0) {
                     ranges.push({
                        label: `${currentMin}-${currentMax}`,
                        min: currentMin,
                        max: currentMax
                    });
                } else if (currentMin <= levelVocabCount && currentMax > levelVocabCount && levelVocab.filter(v => v.originalIndex >= currentMin).length > 0) {
                    if (levelVocab.filter(v => v.originalIndex >= currentMin && v.originalIndex <= levelVocabCount).length > 0){
                        ranges.push({
                            label: `${currentMin}-${levelVocabCount}`, 
                            min: currentMin,
                            max: levelVocabCount 
                        });
                    }
                }
                currentMin += rangeSize;
                 if (currentMin > levelVocabCount && ranges.length > 0 && ranges[ranges.length-1].max < levelVocabCount) {
                    const lastCovered = ranges[ranges.length-1].max;
                     if (levelVocab.filter(v => v.originalIndex > lastCovered && v.originalIndex <= levelVocabCount).length > 0) {
                        ranges.push({
                            label: `${lastCovered + 1}-${levelVocabCount}`,
                            min: lastCovered + 1,
                            max: levelVocabCount
                        });
                    }
                    break; 
                } else if (currentMin > levelVocabCount) {
                    break; 
                }
            }
            
            if (ranges.length === 0 && levelVocabCount > 0) {
                 if (levelVocab.filter(v => v.originalIndex >= 1 && v.originalIndex <= levelVocabCount).length > 0) {
                    ranges.push({
                        label: `1-${levelVocabCount}`,
                        min: 1,
                        max: levelVocabCount
                    });
                }
            }

            let hasButtons = false;
            ranges.forEach(range => {
                const wordsInThisRangeForButton = levelVocab.filter(v => v.originalIndex >= range.min && v.originalIndex <= range.max).length;

                if (wordsInThisRangeForButton > 0) { 
                    const button = document.createElement('button');
                    button.textContent = `${range.label} (${wordsInThisRangeForButton}字)`;
                    button.className = 'w-full font-semibold py-2 px-3 rounded-lg shadow-md transition duration-150 bg-purple-500 hover:bg-purple-600 text-white';
                    button.onclick = () => handleReviewRangeSelectList(level, range.min, range.max); 
                    elements.reviewRangeButtons.appendChild(button);
                    hasButtons = true;
                }
            });

            if(!hasButtons){
                 elements.reviewRangeButtons.innerHTML = `<p class="text-slate-400 col-span-full text-center">此等級詞彙無法按區間劃分，或無有效題號。</p>`;
            }
        }
        
        function handleReviewRangeSelectList(level, minIndex, maxIndex) { 
            currentReviewRange = { min: minIndex, max: maxIndex };
            elements.selectedReviewRangeText.textContent = `${minIndex}-${maxIndex === Infinity ? '之後' : maxIndex}`;
            
            const wordsForReview = vocabByLevel[`level${level}`].filter(word => 
                word.originalIndex >= minIndex && word.originalIndex <= maxIndex
            );

            renderReviewVocabList(wordsForReview);
            elements.reviewVocabListContainer.style.display = 'block';
            if(wordsForReview.length === 0){
                elements.reviewVocabList.innerHTML = '<p class="text-slate-400 text-center py-4">此區間沒有單字。</p>';
            }
        }


        function renderReviewVocabList(words) {
            elements.reviewVocabList.innerHTML = '';
            if (!words || words.length === 0) {
                elements.reviewVocabList.innerHTML = '<p class="text-slate-400 text-center py-4">此區間沒有單字或選擇無效。</p>';
                return;
            }

            words.sort((a,b) => a.originalIndex - b.originalIndex).forEach(word => {
                const li = document.createElement('li');
                li.className = 'p-3 bg-slate-800/50 rounded-md shadow-lg hover:bg-slate-700/70 transition-colors duration-150';

                const errorStat = errorStats.find(stat => 
                    stat.english.toLowerCase() === word.english.toLowerCase() && 
                    stat.chinese.split(' / ').join(' / ') === word.chinese.join(' / ') && 
                    stat.level === word.level
                );
                const errorCount = errorStat ? errorStat.errors : 0;
                const pronounceButtonHTML = createPronounceButton(word.english).outerHTML;

                li.innerHTML = `
                    <div class="flex justify-between items-start mb-1">
                        <h4 class="text-lg font-semibold text-amber-300 flex items-center">
                            <span class="mr-3 text-slate-400 text-sm self-start mt-1">#${word.originalIndex}</span>
                            <span class="flex-grow">${word.english}</span>
                            ${pronounceButtonHTML}
                        </h4>
                        <span class="text-xs whitespace-nowrap ${errorCount > 0 ? 'text-red-400' : 'text-green-500'} font-medium bg-slate-700 px-2 py-1 rounded">
                            錯誤: ${errorCount}
                        </span>
                    </div>
                    ${word.pronunciation ? `<p class="text-sm text-sky-300 ml-8">[${word.pronunciation}]</p>` : '<p class="text-sm text-slate-500 ml-8">(無音標)</p>'}
                    <p class="text-slate-300 text-sm mt-1 ml-8">${word.chinese.join('； ')}</p>
                `;
                elements.reviewVocabList.appendChild(li);
            });
        }
        
        function backToInitialFromReview() { 
            quizState = 'initial';
            updateScreenVisibility();
        }

        // --- Review QUIZ Mode Functions ---
        function startReviewQuizMode() {
            quizState = 'review_quiz_selection';
            currentReviewQuizLevel = null;
            currentReviewQuizRange = null;
            elements.reviewQuizRangeSelection.style.display = 'none';
            elements.reviewQuizModeFeedback.innerHTML = '';
            elements.reviewQuizLevelSelect.value = ""; 
            updateScreenVisibility();
        }

        function populateReviewQuizLevelSelect() {
            elements.reviewQuizLevelSelect.innerHTML = '<option value="">-- 請選擇等級 --</option>';
            for (let i = 1; i <= 8; i++) {
                if (vocabByLevel[`level${i}`] && vocabByLevel[`level${i}`].length > 0) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `Level ${i} (${vocabByLevel[`level${i}`].length} 字)`;
                    elements.reviewQuizLevelSelect.appendChild(option);
                }
            }
        }

        function handleReviewQuizLevelChange(event) {
            const level = event.target.value;
            currentReviewQuizLevel = level ? parseInt(level) : null;
            elements.reviewQuizModeFeedback.innerHTML = '';

            if (currentReviewQuizLevel) {
                elements.selectedReviewQuizLevelText.textContent = currentReviewQuizLevel;
                elements.reviewQuizRangeSelection.style.display = 'block';
                renderReviewQuizRangeButtons(currentReviewQuizLevel);
            } else {
                elements.reviewQuizRangeSelection.style.display = 'none';
            }
        }

        function renderReviewQuizRangeButtons(level) {
            elements.reviewQuizRangeButtons.innerHTML = '';
            const levelVocab = vocabByLevel[`level${level}`] || [];
            const levelVocabCount = levelVocab.length;
            
            if (levelVocabCount === 0) {
                elements.reviewQuizRangeButtons.innerHTML = `<p class="text-slate-400 col-span-full text-center">此等級無詞彙可供選擇區間。</p>`;
                return;
            }

            const rangeSize = 20;
            let ranges = [];
            let currentMin = 1;

            while (currentMin <= levelVocabCount) {
                let currentMax = currentMin + rangeSize - 1;
                const wordsInThisSpecificRange = levelVocab.filter(v => v.originalIndex >= currentMin && v.originalIndex <= currentMax).length;

                if (wordsInThisSpecificRange > 0) {
                     ranges.push({
                        label: `${currentMin}-${currentMax}`,
                        min: currentMin,
                        max: currentMax,
                        actualWords: wordsInThisSpecificRange 
                    });
                } else if (currentMin <= levelVocabCount && currentMax > levelVocabCount && levelVocab.filter(v => v.originalIndex >= currentMin).length > 0) {
                    const actualLastWords = levelVocab.filter(v => v.originalIndex >= currentMin && v.originalIndex <= levelVocabCount).length;
                    if (actualLastWords > 0) {
                        ranges.push({
                            label: `${currentMin}-${levelVocabCount}`,
                            min: currentMin,
                            max: levelVocabCount,
                            actualWords: actualLastWords
                        });
                    }
                }
                currentMin += rangeSize;
                 if (currentMin > levelVocabCount && ranges.length > 0 && ranges[ranges.length-1].max < levelVocabCount) {
                    const lastCovered = ranges[ranges.length-1].max;
                    const remainingWords = levelVocab.filter(v => v.originalIndex > lastCovered && v.originalIndex <= levelVocabCount).length;
                    if (remainingWords > 0) {
                         ranges.push({
                            label: `${lastCovered + 1}-${levelVocabCount}`,
                            min: lastCovered + 1,
                            max: levelVocabCount,
                            actualWords: remainingWords
                        });
                    }
                    break; 
                } else if (currentMin > levelVocabCount) {
                    break; 
                }
            }
            
            if (ranges.length === 0 && levelVocabCount > 0) {
                 const allWordsCount = levelVocab.filter(v => v.originalIndex >= 1 && v.originalIndex <= levelVocabCount).length;
                if (allWordsCount > 0) {
                    ranges.push({
                        label: `1-${levelVocabCount}`,
                        min: 1,
                        max: levelVocabCount,
                        actualWords: allWordsCount
                    });
                }
            }

            let hasButtons = false;
            ranges.forEach(range => {
                if (range.actualWords > 0) { 
                    const button = document.createElement('button');
                    button.textContent = `${range.label} (${range.actualWords}題)`;
                    button.className = 'w-full font-semibold py-2 px-3 rounded-lg shadow-md transition duration-150 bg-indigo-500 hover:bg-indigo-600 text-white';
                    button.onclick = () => startReviewRangeQuiz(level, range.min, range.max);
                    elements.reviewQuizRangeButtons.appendChild(button);
                    hasButtons = true;
                }
            });

            if(!hasButtons){
                 elements.reviewQuizRangeButtons.innerHTML = `<p class="text-slate-400 col-span-full text-center">此等級詞彙無法按區間劃分測驗，或無有效題號。</p>`;
            }
        }

        function startReviewRangeQuiz(level, minIndex, maxIndex) {
            cameFromState = 'review_quiz_selection';
            quizType = 'review_range_quiz'; 
            selectedLevel = level; 
            currentReviewQuizRange = {min: minIndex, max: maxIndex}; 

            const wordsForThisQuiz = vocabByLevel[`level${level}`].filter(word => 
                word.originalIndex >= minIndex && word.originalIndex <= maxIndex
            );

            if (wordsForThisQuiz.length === 0) {
                showUIMessage(elements.reviewQuizModeFeedback, `範圍 ${minIndex}-${maxIndex === Infinity ? '之後' : maxIndex} 內沒有可測驗的單字。`, 'error', 3000);
                return;
            }
            
            quizWords = shuffleArray(wordsForThisQuiz);

            const formattedQuizWords = quizWords.map(word => ({
                id: word.id, 
                questionChinese: word.chinese.join(' / '), 
                answerEnglish: word.english,
                pronunciation: word.pronunciation,
                level: word.level,
            }));

            quizWords = formattedQuizWords; 
            currentWordIndex = 0;
            score = 0; 
            quizState = 'ongoing'; 
            elements.reviewQuizModeFeedback.innerHTML = '';
            renderQuizQuestion(); 
            updateScreenVisibility();
        }

        function backToInitialFromReviewQuiz() {
            quizState = 'initial';
            updateScreenVisibility();
        }

        // --- Core Logic & Event Handlers (Quiz, Errors, etc.) ---
        function handleLevelSelect(level) {
            cameFromState = 'initial';
            selectedLevel = level;
            quizType = 'level';
            startLevelQuiz(level);
        }

        function startLevelQuiz(level) {
            if (isLoading || Object.keys(vocabByLevel).length === 0) {
                showUIMessage(elements.initialFeedbackP, "詞彙庫仍在載入中，請稍候。", 'error', 3000);
                return;
            }
            if (!level) { 
                showUIMessage(elements.initialFeedbackP, "請先選擇一個測驗等級。", 'error', 3000);
                quizState = 'initial'; 
                updateScreenVisibility();
                return; 
            }

            const targetLevelVocab = vocabByLevel[`level${level}`] || [];
            let lowerLevelVocabPool = [];
            for (let i = 1; i < level; i++) {
                lowerLevelVocabPool = lowerLevelVocabPool.concat(vocabByLevel[`level${i}`] || []);
            }

            const totalQuestions = 20;
            const targetLevelCount = Math.ceil(totalQuestions * 0.8);
            const lowerLevelCount = totalQuestions - targetLevelCount;

            let questionsForQuiz = [];
            let usedIds = new Set();

            const addUniqueWords = (sourceArray, count) => {
                const shuffledSource = shuffleArray([...sourceArray]);
                let added = 0;
                for (const word of shuffledSource) {
                    if (added >= count) break;
                    if (word && word.id && !usedIds.has(word.id)) { 
                        questionsForQuiz.push(word);
                        usedIds.add(word.id);
                        added++;
                    }
                }
            };
            
            addUniqueWords(targetLevelVocab, targetLevelCount);

            if (questionsForQuiz.length < targetLevelCount || (level > 1 && lowerLevelVocabPool.length > 0)) {
                 addUniqueWords(lowerLevelVocabPool, lowerLevelCount);
            }
           
            if (questionsForQuiz.length < totalQuestions) {
                const remainingNeeded = totalQuestions - questionsForQuiz.length;
                let combinedPool = targetLevelVocab.concat(lowerLevelVocabPool);
                addUniqueWords(combinedPool, remainingNeeded);
            }

            quizWords = shuffleArray(questionsForQuiz).slice(0, totalQuestions);

            if (quizWords.length === 0 ) {
                showUIMessage(elements.initialFeedbackP, `等級 ${level} 或更低等級的詞彙不足以產生測驗。`, 'error', 4000);
                quizState = 'initial';
                updateScreenVisibility();
                return;
            }
            if (quizWords.length < totalQuestions && quizWords.length > 0) {
                 showUIMessage(elements.initialFeedbackP, `提醒：詞彙量不足 ${totalQuestions} 題，本次測驗共 ${quizWords.length} 題。`, 'info', 4000);
            }

            const formattedQuizWords = quizWords.map(word => ({
                id: word.id, 
                questionChinese: word.chinese.join(' / '), 
                answerEnglish: word.english,
                pronunciation: word.pronunciation,
                level: word.level,
            }));

            quizWords = formattedQuizWords; 
            currentWordIndex = 0;
            score = 0; 
            quizState = 'ongoing';
            elements.initialFeedbackP.innerHTML = '';
            renderQuizQuestion();
            updateScreenVisibility();
        }

        function startErrorReviewQuiz() {
            cameFromState = 'initial';
            const wordsToReview = errorStats.filter(stat => stat.errors > 0);
            if (wordsToReview.length === 0) {
                showUIMessage(elements.initialFeedbackP, "太棒了！目前沒有需要複習的錯誤單字。", 'success', 3000);
                return;
            }
            quizType = 'error_review';
            selectedLevel = null; 

            quizWords = shuffleArray(wordsToReview).map(stat => ({
                id: stat.english + stat.level + stat.chinese,
                questionChinese: stat.chinese,
                answerEnglish: stat.english,
                pronunciation: stat.pronunciation,
                level: stat.level, 
                isErrorReview: true,
            }));
            
            currentWordIndex = 0;
            score = 0;
            quizState = 'ongoing';
            elements.initialFeedbackP.innerHTML = '';
            renderQuizQuestion();
            updateScreenVisibility();
        }

        function normalizeEnglishAnswer(answer) { return answer.trim().toLowerCase(); }

        function handleSubmit() {
            if (!elements.userInputEl.value.trim()) { 
                showUIMessage(elements.quizFeedbackP, '請輸入答案！', 'error', 2000); 
                return; 
            }

            const currentQuizWord = quizWords[currentWordIndex];
            const userAnswer = normalizeEnglishAnswer(elements.userInputEl.value);
            const isCorrect = userAnswer === normalizeEnglishAnswer(currentQuizWord.answerEnglish);

            elements.quizFeedbackP.innerHTML = '';

            if (isCorrect) {
                score++;
                showUIMessage(elements.quizFeedbackP, '答對了！ 🎉', 'success');
                if (quizType === 'error_review') {
                    errorStats = errorStats.map(stat => 
                        stat.english.toLowerCase() === currentQuizWord.answerEnglish.toLowerCase() && stat.chinese === currentQuizWord.questionChinese
                        ? { ...stat, errors: Math.max(0, stat.errors - 1) } 
                        : stat
                    ).filter(stat => stat.errors > 0 );
                    saveErrorStats();
                }
            } else {
                const feedbackContainer = document.createElement('div'); 
                const feedbackText = document.createTextNode(`答錯了！🙁 正確答案是：${currentQuizWord.answerEnglish} `);
                feedbackContainer.appendChild(feedbackText);
                
                const pronounceBtn = createPronounceButton(currentQuizWord.answerEnglish);
                feedbackContainer.appendChild(pronounceBtn);
                
                showUIMessage(elements.quizFeedbackP, '', 'error'); 
                elements.quizFeedbackP.innerHTML = ''; 
                elements.quizFeedbackP.appendChild(feedbackContainer); 
                if (elements.quizFeedbackP.firstChild && elements.quizFeedbackP.firstChild.classList) {
                    elements.quizFeedbackP.firstChild.classList.add('ui-message', 'ui-message-error');
                }

                const wordToFind = currentQuizWord.answerEnglish.toLowerCase();
                const existingStatIndex = errorStats.findIndex(stat => 
                    stat.english.toLowerCase() === wordToFind && stat.chinese === currentQuizWord.questionChinese
                );
                if (existingStatIndex > -1) {
                    errorStats[existingStatIndex].errors++;
                } else {
                    errorStats.push({
                        english: currentQuizWord.answerEnglish, 
                        pronunciation: currentQuizWord.pronunciation,
                        chinese: currentQuizWord.questionChinese, 
                        errors: 1,
                        level: currentQuizWord.level 
                    });
                }
                saveErrorStats();
            }

            elements.userInputEl.value = ''; 
            setTimeout(() => {
                if (currentWordIndex < quizWords.length - 1) {
                    currentWordIndex++;
                    renderQuizQuestion();
                } else {
                    quizState = 'finished';
                    renderFinishedScreen();
                    updateScreenVisibility();
                }
            }, isCorrect ? 1000 : 2500);
        }
        
        function handleBackFromQuiz() {
            const confirmLeave = confirm("您確定要離開目前的測驗嗎？進度將不會被儲存。");
            if (confirmLeave) {
                quizState = cameFromState; 
                quizWords = [];
                currentWordIndex = 0;
                score = 0;
                if (elements.quizFeedbackP) elements.quizFeedbackP.innerHTML = '';
                if (elements.userInputEl) elements.userInputEl.value = '';
                
                updateScreenVisibility();
            }
        }

        function handleClearErrorsRequest() {
            elements.clearConfirmModal.style.display = 'flex';
        }
        function confirmClearErrors() {
            errorStats = [];
            saveErrorStats();
            elements.clearConfirmModal.style.display = 'none';
            const message = '累積錯誤記錄已清除。';
            if (quizState === 'initial') {
                showUIMessage(elements.initialFeedbackP, message, 'success', 3000);
                updateInitialScreenElements();
            } else if (quizState === 'finished') {
                showUIMessage(elements.finishedFeedbackP, message, 'success', 3000);
                renderFinishedScreen();
            }
        }
        function cancelClearErrors() {
            elements.clearConfirmModal.style.display = 'none';
        }

        function resetToInitial() {
            quizState = 'initial';
            selectedLevel = null;
            quizType = 'level'; 
            elements.initialFeedbackP.innerHTML = '';
            elements.finishedFeedbackP.innerHTML = '';
            updateScreenVisibility();
        }

        function handleShowErrorList() {
            const currentErrorWords = errorStats.filter(stat => stat.errors > 0);
            elements.errorListModalContentDiv.innerHTML = '';

            if (currentErrorWords.length === 0) {
                 elements.errorListModalContentDiv.innerHTML = '<p class="text-slate-300 text-center">目前沒有錯誤單字記錄。</p>';
            } else {
                const sortedErrorWords = [...currentErrorWords].sort((a,b) => b.errors - a.errors);
                const ul = document.createElement('ul');
                ul.className = 'space-y-3';
                sortedErrorWords.forEach(word => {
                    const li = document.createElement('li');
                    li.className = 'p-3 bg-slate-700 rounded-md shadow';
                    const pronunciationText = word.pronunciation ? `<span class="text-sm text-slate-400 ml-2">[${word.pronunciation}]</span>` : '';
                    const pronounceButtonHTML = createPronounceButton(word.english).outerHTML;

                    li.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div>
                                <span class="font-semibold text-lg text-amber-300">${word.english}</span>
                                ${pronounceButtonHTML}
                                ${pronunciationText}
                            </div>
                            <span class="text-sm text-red-400">錯誤 ${word.errors} 次</span>
                        </div>
                        <p class="text-slate-300 mt-1 text-sm">${word.chinese}</p>
                        <p class="text-xs text-slate-500 mt-1">等級: ${word.level || '未知'}</p>
                    `;
                    ul.appendChild(li);
                });
                elements.errorListModalContentDiv.appendChild(ul);
            }
            elements.errorListModal.style.display = 'flex';
        }
        function handleCloseErrorList() {
            elements.errorListModal.style.display = 'none';
        }

        // --- Initialization ---
        function initApp() {
            elements.appContainer = document.getElementById('app-container');
            elements.initialScreen = document.getElementById('initial-screen');
            elements.quizScreen = document.getElementById('quiz-screen');
            elements.finishedScreen = document.getElementById('finished-screen');
            elements.reviewModeScreen = document.getElementById('review-mode-screen');
            elements.reviewQuizSelectionScreen = document.getElementById('review-quiz-selection-screen');
            
            elements.levelSelectionButtonsContainer = document.getElementById('level-selection-buttons');
            elements.errorReviewCountSpan = document.getElementById('error-review-count');
            elements.startErrorReviewQuizBtn = document.getElementById('start-error-review-quiz-btn');
            elements.showErrorListBtn = document.getElementById('show-error-list-btn');
            elements.clearErrorsInitialBtn = document.getElementById('clear-errors-initial-btn');
            elements.initialFeedbackP = document.getElementById('initial-feedback');

            elements.quizProgressTextP = document.getElementById('quiz-progress-text');
            elements.questionChineseTextP = document.getElementById('question-chinese-text');
            elements.userInputEl = document.getElementById('user-input');
            elements.submitAnswerBtn = document.getElementById('submit-answer-btn');
            elements.quizFeedbackP = document.getElementById('quiz-feedback');
            elements.backFromQuizBtn = document.getElementById('back-from-quiz-btn');


            elements.finishedTitleH2 = document.getElementById('finished-title');
            elements.finalScoreTextP = document.getElementById('final-score-text');
            elements.errorSummaryContainer = document.getElementById('error-summary-container');
            elements.errorSummaryListUl = document.getElementById('error-summary-list');
            elements.noCumulativeErrorsMsgP = document.getElementById('no-cumulative-errors-msg');
            elements.finishedFeedbackP = document.getElementById('finished-feedback');
            elements.resetToInitialBtn = document.getElementById('reset-to-initial-btn');
            elements.clearErrorsFinishedBtn = document.getElementById('clear-errors-finished-btn');
            
            elements.totalVocabCountTextP = document.getElementById('total-vocab-count-text');

            elements.clearConfirmModal = document.getElementById('clear-confirm-modal');
            elements.confirmClearBtn = document.getElementById('confirm-clear-btn');
            elements.cancelClearBtn = document.getElementById('cancel-clear-btn');

            elements.errorListModal = document.getElementById('error-list-modal');
            elements.errorListModalContentDiv = document.getElementById('error-list-modal-content');
            elements.closeErrorListBtn = document.getElementById('close-error-list-btn');

            elements.startReviewModeBtn = document.getElementById('start-review-mode-btn');
            elements.reviewLevelSelect = document.getElementById('review-level-select');
            elements.reviewRangeSelection = document.getElementById('review-range-selection');
            elements.selectedReviewLevelText = document.getElementById('selected-review-level-text');
            elements.reviewRangeButtons = document.getElementById('review-range-buttons');
            elements.reviewVocabListContainer = document.getElementById('review-vocab-list-container');
            elements.selectedReviewRangeText = document.getElementById('selected-review-range-text');
            elements.reviewVocabList = document.getElementById('review-vocab-list');
            elements.reviewModeFeedback = document.getElementById('review-mode-feedback');
            elements.backToInitialFromReviewBtn = document.getElementById('back-to-initial-from-review-btn');
            elements.reviewListLevelText = document.getElementById('review-list-level-text');

            elements.startReviewQuizModeBtn = document.getElementById('start-review-quiz-mode-btn');
            elements.reviewQuizLevelSelect = document.getElementById('review-quiz-level-select');
            elements.reviewQuizRangeSelection = document.getElementById('review-quiz-range-selection');
            elements.selectedReviewQuizLevelText = document.getElementById('selected-review-quiz-level-text');
            elements.reviewQuizRangeButtons = document.getElementById('review-quiz-range-buttons');
            elements.reviewQuizModeFeedback = document.getElementById('review-quiz-mode-feedback');
            elements.backToInitialFromReviewQuizBtn = document.getElementById('back-to-initial-from-review-quiz-btn');


            isLoading = true;
            const allLevelsRaw = {
                1: rawLevel1Vocab, 2: rawLevel2Vocab, 3: rawLevel3Vocab, 4: rawLevel4Vocab,
                5: rawLevel5Vocab, 6: rawLevel6Vocab, 7: rawLevel7Vocab, 8: rawLevel8Vocab,
            };
            let totalParsed = 0;
            for (let level = 1; level <= 8; level++) {
                if (allLevelsRaw[level] && allLevelsRaw[level].trim() !== "/* <<<<< 在此貼上 Level " + level + " 的完整詞彙資料 >>>>> */" && allLevelsRaw[level].trim() !== "/* 貼上 Level " + level + " 詞彙 */" ) {
                    vocabByLevel[`level${level}`] = parseVocabulary(allLevelsRaw[level], level);
                    totalParsed += vocabByLevel[`level${level}`].length;
                } else {
                    vocabByLevel[`level${level}`] = [];
                    // console.warn(`詞彙資料 Level ${level} 未提供或為空。`);
                }
            }
            isLoading = false;
            elements.totalVocabCountTextP.textContent = `總詞彙數 (已載入): ${totalParsed}`;
            renderLevelSelectionButtons();

            try {
                const storedErrorStats = localStorage.getItem('vocabGlobalErrorStats');
                if (storedErrorStats) {
                    const parsedStats = JSON.parse(storedErrorStats);
                    if (Array.isArray(parsedStats)) errorStats = parsedStats;
                }
            } catch (error) {
                console.error("讀取 localStorage 錯誤統計失敗:", error);
                showUIMessage(elements.initialFeedbackP, "讀取先前錯誤記錄失敗。", 'error', 5000);
            }

            elements.startErrorReviewQuizBtn.onclick = startErrorReviewQuiz;
            elements.showErrorListBtn.onclick = handleShowErrorList;
            elements.clearErrorsInitialBtn.onclick = handleClearErrorsRequest;
            elements.clearErrorsFinishedBtn.onclick = handleClearErrorsRequest;
            
            elements.submitAnswerBtn.onclick = handleSubmit;
            elements.userInputEl.onkeypress = (event) => {
                if (event.key === 'Enter' && quizState === 'ongoing') handleSubmit();
            };
            
            elements.resetToInitialBtn.onclick = resetToInitial;

            elements.confirmClearBtn.onclick = confirmClearErrors;
            elements.cancelClearBtn.onclick = cancelClearErrors;
            elements.closeErrorListBtn.onclick = handleCloseErrorList;

            elements.startReviewModeBtn.onclick = startListReviewMode; 
            elements.reviewLevelSelect.onchange = handleReviewLevelChange; 
            elements.backToInitialFromReviewBtn.onclick = backToInitialFromReview; 

            elements.startReviewQuizModeBtn.onclick = startReviewQuizMode; 
            elements.reviewQuizLevelSelect.onchange = handleReviewQuizLevelChange; 
            elements.backToInitialFromReviewQuizBtn.onclick = backToInitialFromReviewQuiz;
            
            if (elements.backFromQuizBtn) {
                elements.backFromQuizBtn.onclick = handleBackFromQuiz;
            }


            const pronounceHandler = function(event) {
                const button = event.target.closest('.pronounce-btn');
                if (button) {
                    const textToSpeak = button.dataset.text;
                    speakText(textToSpeak);
                }
            };
            elements.errorListModalContentDiv.addEventListener('click', pronounceHandler);
            elements.quizFeedbackP.addEventListener('click', pronounceHandler);
            elements.errorSummaryListUl.addEventListener('click', pronounceHandler);
            elements.reviewVocabList.addEventListener('click', pronounceHandler);

            updateScreenVisibility();
        }
        
        function saveErrorStats() {
            try {
                localStorage.setItem('vocabGlobalErrorStats', JSON.stringify(errorStats));
            } catch (error) {
                console.error("儲存錯誤統計至 localStorage 失敗:", error);
                 showUIMessage(elements.initialFeedbackP, "儲存錯誤記錄失敗。", 'error', 5000);
            }
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
